crossprod(l3,l4)
crossprod(h3,h4)
crossprod(h2,h3)
crossprod(h1,h3)
crossprod(h1,h2)
crossprod(h2,h3)
crossprod(h3,h4)
crossprod(h2,h3)
coef
crossprod(h2,h3)
crossprod(h2,h3)
crossprod(h2,h4)
crossprod(h3,h4)
model.matrix(modf)
coef
mp11=c(1,0,1,1,0,1,0)
mp21=c(1,0,-1,1,0,-1,0)
mp12=c(1,0,1,0,1,0,1)
mp22=c(1,0,-1,0,1,0,-1)
mp13=c(1,0,1,-1,-1,-1,-1)
mp23=c(1,0,-1,-1,-1,1,1)
## Las diferencias
h2=mp11-mp21
h3=mp22-mp12
h4=mp23-mp13
## Los contrastes
l2=h2%*%coef;l2
l3=h3%*%coef;l3
l4=h4%*%coef;l4
crossprod(h2,h3)
crossprod(h2,h4)
crossprod(h3,h4)
model.matrix(modf)
h2
t(h2)%*%vcov(modf)%*%h2
t(h2)%*%vcov(modf)%*%h2
t(h3)%*%vcov(modf)%*%h3
t(h4)%*%vcov(modf)%*%h4
ee=sqrt(t(h2)%*%vcov(modf)%*%h2)
t2=l2/ee;t2
t2=l2/ee;t2
t3=l3/ee;t3
t4=l4/ee;t4
pt(t2,17)
pt(t2,17,lower.tail = F)
pt(t2,17,lower.tail = F)
pt(t3,17,lower.tail = F)
pt(t4,17,lower.tail = F)
qt(1-0.05,18)
qt(1-0.05,17)
qt=qt(1-0.05,17)
l3-qt*ee
l3-qt*ee
l4-qt*ee
qt=qt(1-0.05/2,17)
l3-qt*ee
l4-qt*ee
l4-qt*ee;l4+qt*ee
l3-qt*ee;l3+qt*ee
l4-qt*ee;l4+qt*ee
load("salsa3.Rdata")
View(base)
str(base)
plot(base$puntaje~base$persona)
View(base)
plot(base$puntaje~base$persona,type="l")
plot(base$puntaje~base$pic,type="l")
plot(base$puntaje)
plot(base$puntaje,base$persona)
plot(base$puntaje,base$persona,col=levels(base$pic))
plot(base$puntaje,base$persona,col=base$pic)
plot(base$persona,base$puntaje,col=base$pic)
plot(base$persona,base$puntaje)
View(base)
library(ggplot2)
ggplot(base,aes(x=persona))
ggplot(base,aes(x=persona,y=puntaje))
ggplot(base,aes(x=persona,y=puntaje,group = pic))
ggplot(base,aes(x=persona,y=puntaje,group = pic))+
stat_summary(fun="mean",geom = line,aes(linetype = pic))
library(ggplot2)
ggplot(base,aes(x=persona,y=puntaje,group = pic))+
stat_summary(fun="mean",geom = line,aes(linetype = pic))
ggplot(base,aes(x=persona,y=puntaje,group = pic))+
stat_summary(fun="mean",geom = "line",aes(linetype = pic))
boxplot(base$puntaje~base$pic+base$tomate)
View(base)
modc=lm(puntaje~persona,data = base)
fit=modc$fit
rc=base$puntaje−fit+mean(base$puntaje)
rc=base$puntaje-fit+mean(base$puntaje)
boxplot(rc~base$pic+base$tomate)
boxplot(base$puntaje~base$pic+base$tomate)
boxplot(rc~base$pic+base$tomate)
n=nrow(base)
var=var(base$puntaje)
sum((n-1)*var)
View(base)
mod0=aov(puntaje~pic+tomate,data = base)
anova(mod0)
anova(mod0)[,2]
sum(anova(mod0)[,2])
mpic=tapply(base$puntaje,base$pic,mean)
mpic
mtom=tapply(base$puntaje,base$ptom,mean)
mtom=tapply(base$puntaje,base$tomate,mean)
mtom
mg=mean(base$puntaje)
ai=mpic-mg;ai
bi=mtom-mg;bi
ai=mpic-mg;ai
options(contrasts = c("contr.sum","contr.poly"))
mod0=aov(puntaje~pic+tomate,data = base)
sum(anova(mod0)[,2])
mpic=tapply(base$puntaje,base$pic,mean)
mpic
mtom=tapply(base$puntaje,base$tomate,mean)
mtom
mg=mean(base$puntaje)
ai=mpic-mg;ai
bi=mtom-mg;bi
mod0$coefficients
ai=mpic-mg;ai
bi=mtom-mg;bi
mod0$coefficients
View(base)
sctrat1=sum(b*ai^2)
b=8
a=3
sctrat1=sum(b*ai^2)
cmtrat1=sctrat1/a-1
cmtrat1
anova(mod0)
(sctrat1=sum(b*ai^2))
(sctrat1=sum(b*ai^2))
(sctrat1=sum(16*ai^2))
cmtrat1=sctrat1/a-1
cmtrat1
b=16
a=3
(sctrat1=sum(b*ai^2))
cmtrat1=sctrat1/a-1
cmtrat1
cmtrat1=sctrat1/(a-1)
cmtrat1
table(base$tomate)
table(base$tomate)
b=24
a=2
(sctrat2=sum(b*bi^2))
cmtrat2=sctrat2/(a-1)
cmtrat2
load("salsa3.Rdata")
str(base)
library(ggplot2)
ggplot(base,aes(x=persona,y=puntaje,group = pic))+
stat_summary(fun="mean",geom = "line",aes(linetype = pic))
boxplot(base$puntaje~base$pic+base$tomate)
modc=lm(puntaje~persona,data = base)
fit=modc$fit
rc=base$puntaje-fit+mean(base$puntaje)
boxplot(base$puntaje~base$pic+base$tomate)
boxplot(rc~base$pic+base$tomate)
n=nrow(base)
var=var(base$puntaje)
sum((n-1)*var)
options(contrasts = c("contr.sum","contr.poly"))
mod0=aov(puntaje~pic*tomate,data = base)
sum(anova(mod0)[,2])
mpic=tapply(base$puntaje,base$pic,mean)
mpic
mtom=tapply(base$puntaje,base$tomate,mean)
mtom
mg=mean(base$puntaje)
ai=mpic-mg;ai
bi=mtom-mg;bi
mod0$coefficients
b=16 ## Preguntar: Cantidad de bloques o de réplicas
a=3
(sctrat1=sum(b*ai^2))
cmtrat1=sctrat1/(a-1)
cmtrat1
table(base$tomate)
b=24
a=2
(sctrat2=sum(b*bi^2))
cmtrat2=sctrat2/(a-1)
cmtrat2
anova(mod0)
mod0=aov(puntaje~persona+pic*tomate,data = base)
mod1=aov(puntaje~persona+pic*tomate,data = base)
anova
anova(mod1)
mp=tapply(base$puntaje,base$persona,mean);mp
sum(a*(mp-mg)^2)
a=6
b=8
mp=tapply(base$puntaje,base$persona,mean);mp
sum(a*(mp-mg)^2)
table(base$persona)
a=6
b=8
mp=tapply(base$puntaje,base$persona,mean);mp
sum(a*(mp-mg)^2)
tapply(base$puntaje,list(base$tomate,base$pic),varf)
tapply(base$puntaje,list(base$tomate,base$pic),var)
mean(tapply(base$puntaje,list(base$tomate,base$pic),var))
anova(mod0)
mean(tapply(base$puntaje,list(base$tomate,base$pic),var))
anova(mod0)
anova(mod1)
anova(mod0)
mean(tapply(base$puntaje,list(base$tomate,base$pic),var))
anova(mod1)
anova(mod0)
mean(tapply(base$puntaje,list(base$tomate,base$pic),var))
anova(mod0)
anova(mod1)
load("salsa3.Rdata")
str(base)
library(ggplot2)
ggplot(base,aes(x=persona,y=puntaje,group = pic))+
stat_summary(fun="mean",geom = "line",aes(linetype = pic))
boxplot(base$puntaje~base$pic+base$tomate)
modc=lm(puntaje~persona,data = base)
fit=modc$fit
rc=base$puntaje-fit+mean(base$puntaje)
boxplot(base$puntaje~base$pic+base$tomate)
boxplot(rc~base$pic+base$tomate)
n=nrow(base)
var=var(base$puntaje)
sum((n-1)*var)
options(contrasts = c("contr.sum","contr.poly"))
mod0=aov(puntaje~pic*tomate,data = base)
sum(anova(mod0)[,2])
mpic=tapply(base$puntaje,base$pic,mean)
mpic
mtom=tapply(base$puntaje,base$tomate,mean)
mtom
mg=mean(base$puntaje)
ai=mpic-mg;ai
bi=mtom-mg;bi
mod0$coefficients
b=16 ## Preguntar: Cantidad de bloques o de réplicas
a=3
(sctrat1=sum(b*ai^2))
cmtrat1=sctrat1/(a-1)
cmtrat1
table(base$tomate)
b=24
a=2
(sctrat2=sum(b*bi^2))
cmtrat2=sctrat2/(a-1)
cmtrat2
mod1=aov(puntaje~persona+pic*tomate,data = base)
anova(mod1)
a=6
b=8
mp=tapply(base$puntaje,base$persona,mean);mp
sum(a*(mp-mg)^2)
mean(tapply(base$puntaje,list(base$tomate,base$pic),var))
anova(mod1)
anova(mod1)
anova(mod0)
mean(tapply(base$puntaje,list(base$tomate,base$pic),var))
anova(mod0)
anova(mod1)
sctot=sum(anova(mod1)[,2]);sctot
scres=sctot-scbloq;scres
sctot=sum(anova(mod1)[,2]);sctot
scbloq=0.855
scres=sctot-scbloq;scres
cmres=scres/((n-1)-(2-1+3-1));cmres
scres=sctot-sctrat1;scres
scres=sctot-sctrat1-sctrat2-scbloq;scres
load("salsa3.Rdata")
str(base)
library(ggplot2)
ggplot(base,aes(x=persona,y=puntaje,group = pic))+
stat_summary(fun="mean",geom = "line",aes(linetype = pic))
boxplot(base$puntaje~base$pic+base$tomate)
modc=lm(puntaje~persona,data = base)
fit=modc$fit
rc=base$puntaje-fit+mean(base$puntaje)
boxplot(base$puntaje~base$pic+base$tomate)
boxplot(rc~base$pic+base$tomate)
n=nrow(base)
var=var(base$puntaje)
sum((n-1)*var)
options(contrasts = c("contr.sum","contr.poly"))
mod0=aov(puntaje~pic*tomate,data = base)
sum(anova(mod0)[,2])
mpic=tapply(base$puntaje,base$pic,mean)
mpic
mtom=tapply(base$puntaje,base$tomate,mean)
mtom
mg=mean(base$puntaje)
ai=mpic-mg;ai
bi=mtom-mg;bi
mod0$coefficients
b=16 ## Preguntar: Cantidad de bloques o de réplicas
a=3
(sctrat1=sum(b*ai^2))
cmtrat1=sctrat1/(a-1)
cmtrat1
table(base$tomate)
b=24
a=2
(sctrat2=sum(b*bi^2))
cmtrat2=sctrat2/(a-1)
cmtrat2
mod1=aov(puntaje~persona+pic*tomate,data = base)
anova(mod1)
a=6
b=8
mp=tapply(base$puntaje,base$persona,mean);mp
sum(a*(mp-mg)^2)
mean(tapply(base$puntaje,list(base$tomate,base$pic),var))
anova(mod0)
scbloq=sum(a*(mp-mg)^2);scbloq
scres=sctot-sctrat1-sctrat2-scbint-scbloq;scres
sctot=sum(anova(mod1)[,2]);sctot
scint=0.855
scres=sctot-sctrat1-sctrat2-scbint-scbloq;scres
scres=sctot-sctrat1-sctrat2-scint-scbloq;scres
cmres=scres/((n-1)-(2-1+3-1));cmres
anova(mod1)
anova(mod1)
sctot=sum(anova(mod1)[,2]);sctot
scint=0.855
scres=sctot-sctrat1-sctrat2-scint-scbloq;scres
cmres=scres/((n-1)-(2-1+3-1));cmres
scres=sctot-sctrat1-sctrat2-scint-scbloq;scres
anova(mod1)
sctot=sum(anova(mod1)[,2]);sctot
scint=0.855
scres=sctot-sctrat1-sctrat2-scint-scbloq;scres
cmres=scres/((n-1)-(2-1+3-1));cmres
mod1$coefficients
anova(mod1)
sctot=sum(anova(mod1)[,2]);sctot
scint=0.855
scres=sctot-sctrat1-sctrat2-scint-scbloq;scres
scres/42
anova(mod1)
scres/42
anova(mod1)
scres/35
anova(mod1)
(n-1)
(n-1)-(6-1+8-1)
anova(mod1)
n-13
anova(mod1)
scint
scint/6
scint/2
cmint=scint/2
cmres
scres
scres/35
cmres=scres/35
cmint=scint/2
cmres=scres/35
cmint/cmres
f=cmint/cmres
pf(f,6,35,lower.tail = F)
pf(f,6,35,lower.tail = T)
pf(f,2,35,lower.tail = T)
pf(f,2,35,lower.tail = F)
anova(mod1)
cmresDA=((8-1)*1.7919+8*(6-1)*0.4970)
cmresDA=((8-1)*1.7919+8*(6-1)*0.4970)/(8*6-1)
cmresDA=((8-1)*1.7919+8*(6-1)*0.4970)/(8*6-1);cmresDA
anova(mod1)
er=((35+1)*(42+3)*cmresDA)/((35+3)*(42+1)*cmres)
er
er*8
anova(mod1)
cmresDA=((8-1)*1.7919+8*(6-1)*0.4970)/(8*6-1);cmresDA
er=((35+1)*(42+3)*cmresDA)/((35+3)*(42+1)*cmres)
er*8
er*48
load("Mariposas2.csv")
read.csv("Mariposas2.csv")
read.csv("Mariposas2.csv",sep = ";")
base=read.csv("Mariposas2.csv",sep = ";")
View(base)
View(base)
base$bloque=paste(base$sitio,base$semana)
View(base)
str(base)
base$bloque=as.factor(paste(base$sitio,base$semana))
str(base)
base$especie=as.factor(base$especie)
str(base)
base=read.csv("Mariposas2.csv",sep = ";")
base$bloque=as.factor(paste(base$sitio,base$semana))
base$tipo=as.factor(base$tipo)
base$altura=as.factor(base$altura)
base$especie=as.factor(base$especie)
str(base)
library(ggplot2)
View(base)
library(ggplot2)
ggplot(base,aes(x=bloque,y=frec,group = paste(altura,especie)))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  paste(altura,especie)))
tapply(base$frec,base$bloque,mean)
plot(mb)
mb=tapply(base$frec,base$bloque,mean)
plot(mb)
plot(mb,type = "b")
modc=lm(frec~bloque, data = base)
fit=modc$fit
fit
boxplot(fit~altura+especie,data = base)
boxplot(fit~base$altura+base$especie)
rc=base$frec-fit+mean(base$frec)
boxplot(rc~base$altura+base$especie)
boxplot(base$frec~base$altura+base$especie)
boxplot(rc~base$altura+base$especie)
boxplot(base$frec~base$altura+base$especie)
boxplot(base$frec~base$altura+base$especie,ylim=c(0,12))
boxplot(rc~base$altura+base$especie,ylim=c(0,12))
boxplot(base$frec~base$altura+base$especie,ylim=c(0,12))
modc=lm(frec~bloque, data = base)
fit=modc$fit
rc=base$frec-fit+mean(base$frec)
boxplot(rc~base$altura+base$especie,ylim=c(0,12))
boxplot(base$frec~base$altura+base$especie,ylim=c(0,12))
mod0=aov(frec~bloque+especie*altura,data = base)
anova(mod0)
mod1=aov(frec~bloque+especie+altura,data = base)
anova(mod1)
mod1=aov(frec~bloque+especie+altura,data = base)
anova(mod0)
anova(mod1)
base=read.csv("Mariposas2.csv",sep = ";")
base$bloque=as.factor(paste(base$sitio,base$semana))
base$tipo=as.factor(base$tipo)
base$altura=as.factor(base$altura)
base$especie=as.factor(base$especie)
str(base)
library(ggplot2)
ggplot(base,aes(x=bloque,y=frec,group = paste(altura,especie)))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  paste(altura,especie)))
mb=tapply(base$frec,base$bloque,mean)
plot(mb,type = "b")
modc=lm(frec~bloque, data = base)
fit=modc$fit
rc=base$frec-fit+mean(base$frec)
boxplot(rc~base$altura+base$especie,ylim=c(0,12))
boxplot(base$frec~base$altura+base$especie,ylim=c(0,12))
mod0=aov(frec~bloque+especie*altura,data = base)
mod1=aov(frec~especie*altura,data = base)
anova(mod0)
anova(mod1)
pf(1,45,1)
pf(1,1,45)
pf(1,45,1)
1-pf(1,45,1)
ggplot(base,aes(x=altura,y=frec,group = tipo))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  tipo))
ggplot(base,aes(x=altura,y=frec,group = tipo))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  tipo))
ggplot(base,aes(x=especie,y=frec,group = tipo))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  tipo))
ggplot(base,aes(x=tipo,y=frec,group = especie))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  especie))
ggplot(base,aes(x=tipo,y=frec,group = especie))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  especie))
ggplot(base,aes(x=tipo,y=frec,group = altura))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  altura))
ggplot(base,aes(x=tipo,y=frec,group = especie))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  especie))
ggplot(base,aes(x=tipo,y=frec,group = altura))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  altura))
ggplot(base,aes(x=tipo,y=frec,group = especie))+ stat_summary(fun = "mean",geom = "line",aes(linetype =  especie))
lmer()
library(lme4)
lmer(frec~altura*especie,data = base)
lmer(frec~altura*especie+tipo*altura+tipo*especie,data = base)
lmer(frec~altura*especie+tipo*altura+tipo*especie+(1|bloque),data = base)
modm=lmer(frec~altura*especie+tipo*altura+tipo*especie+(1|bloque),data = base)
library(lme4)
modm=lmer(frec~altura*especie+tipo*altura+tipo*especie+(1|bloque),data = base)
modm
library(lme4)
modm=lmer(frec~altura*especie+tipo*altura+tipo*especie+(1|bloque),data = base)
modm
anova(modm)
summary(modm)
table(base$altura,base$especie,base$tipo)
table(base$tipo)
table(base$bloque,base$tipo)
glp=a*(r-1)
a=2
r=8
glp=a*(r-1)
glp
modt=lm(frec~~altura*especie+tipo*altura+tipo*especie,data = base)
modt=lm(frec~altura*especie+tipo*altura+tipo*especie,data = base)
anova(modt)
anova(modt)[7,1]
anova(modt)[7,1]-14
anova(modm)
drop1(modm)
drop1(modm,test = "chisq")
drop1(modm,test = "Chisq")
anova(modm)
anova(modm)[3:6,4]
anova(modm)
anova(modm)[4:6,4]
anova(modm)
pf(f,1,43)
anova(modm)
drop1(modm,test = "Chisq")
f=anova(modm)[4:6,4]
pf(f,1,43)
pf(f,1,43)
pf(f,1,43,lower.tail = T)
pf(f,1,43,lower.tail = F)
