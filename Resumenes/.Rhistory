r=3
a=7
lambda=r*(p-1)/(a-1)
sctrata=num/(lambda*a)
sctrata
scres=2600.286-(1317.429+1114.286);scres
cmtrat=sctrata/6
cmres=scres/((nrow(base)-1)-(6+6))
cmres
f=cmtrat/cmres;f
pf(f,6,8,lower.tail = F)
mod2=lm(res~dia+conc,data = base)
anova(mod2)
library(ibd)
aov.ibd(res~dia+conc,data = base)
options(contrasts = c("contr.sum","contr.poly"))
mod2=lm(res~dia+conc,data = base)
coef=mod2$coefficients
coef
coef=coef[c(1,8:13)]
coef
c1=c(1,1,0,0,0,0,0)
c2=c(1,0,1,0,0,0,0)
c3=c(1,0,0,1,0,0,0)
c4=c(1,0,0,0,1,0,0)
c5=c(1,0,0,0,0,1,0)
c6=c(1,0,0,0,0,0,1)
c7=c(1,-1,-1,-1,-1,-1,-1)
coef%*%c1
coef%*%c2
coef%*%c3
coef%*%c4
coef%*%c5
coef%*%c6
coef%*%c7
(mo=tapply(base$res,base$conc,mean))
c1=c(1,0,0,0,0,0)
c2=c(0,1,0,0,0,0)
c3=c(0,0,1,0,0,0)
c4=c(0,0,0,1,0,0)
c5=c(0,0,0,0,1,0)
c6=c(0,0,0,0,0,1)
c7=c(-1,-1,-1,-1,-1,-1)
coef=coef[-1]
vcov=vcov(mod2)[c(8:13),c(8:13)]
h12=c1-c2
h13=c1-c3
h14=c1-c4
h15=c1-c5
h16=c1-c6
h17=c1-c7
h23=c2-c3
h24=c2-c4
h25=c2-c5
h26=c2-c6
h27=c2-c7
h34=c3-c4
h35=c3-c5
h36=c3-c6
h37=c3-c7
h45=c4-c5
h46=c4-c6
h47=c4-c7
h56=c5-c6
h57=c5-c7
h67=c6-c7
h=cbind(h12,h13,h14,h15,h16,h17,h23,h24,h25,h26,h27,h34,h35,h36,h37,h45,h46,h47,h56,h57,h67)
(ee=sqrt(diag(t(h)%*%vcov%*%h)))
sqrt((2*cmres)/3)
l=t(h)%*%coef
l=abs(l)
nrow(l)
q=l/ee
ptukey(q,7,8,lower.tail = F)
str(base)
base$conc=as.factor(base$conc)
base$dia=as.factor(base$dia)
str(base)
base$conc=as.factor(base$conc)
base$dia=as.factor(base$dia)
modc=lm(res~dia,data = base)
fit=modc$fit
rc=base$res-fit+mean(base$res)
boxplot(res~conc,data = base)
boxplot(rc~base$conc)
View(base)
mod1=lm(res~conc+dia,data = base)
sum(anova(mod1)[,2])
a=7
yk=tapply(base$res,base$dia,mean)
yb=mean(base$res)
anova(mod1)
sum(3*(yk-yb)^2)
yjp=tapply(base$res,base$conc,sum)
ypk=tapply(base$res,base$dia,sum)
p=3
njk=table(base$conc,base$dia)
qj=yjp-as.vector(njk%*%ypk/p)
(ee=sqrt(diag(t(h)%*%vcov%*%h)))
sqrt((2*cmres)/3)
l=t(h)%*%coef
l=abs(l)
nrow(l)
q=l/ee
ptukey(q,7,8,lower.tail = F)
load("refrescos.rdata")
str(base)
mo=tapply(base$desvabs,list(base$carbonatacion,base$presion,base$rapidez),mean)
mo
library(ggplot2)
ggplot(base,aes(x=carbonatacion,y=desvabs,group = presion))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = presion))
ggplot(base,aes(x=rapidez,y=desvabs,group = presion))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = presion))
ggplot(base,aes(x=carbonatacion,y=desvabs,group = rapidez))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = rapidez))
mcp=tapply(base$desvabs,list(base$carbonatacion,base$presion),mean)
mpr=tapply(base$desvabs,list(base$presion,base$rapidez),mean)
mcr=tapply(base$desvabs,list(base$carbonatacion,base$rapidez),mean)
mcp
mpr
mcr
mc=tapply(base$desvabs,base$carbonatacion,mean)
mp=tapply(base$desvabs,base$presion,mean)
mr=tapply(base$desvabs,base$rapidez,mean)
mc;mp;mr
mg=mean(base$desvabs);mg
ec=mc-mg
ep=mp-mg
er=mr-mg
ec;ep;er
icp=mcp[1,1]-(mg+ec[1]+ep[1])
ipr=mpr[1,1]-(mg+ep[1]+er[1])
icr=mcr[1,1]-(mg+er[1]+ec[1])
icp
ipr
icr
options(contrasts = c("contr.sum","contr.poly"))
mod=lm(desvabs~carbonatacion*presion+carbonatacion*rapidez+rapidez*presion,data = base)
mod$coefficients
library(lattice)
xyplot(base$desvabs~base$carbonatacion|base$rapidez,group=base$presion,pch=18,type="a")
mo[1,1,1]-(mg+ec[1]+ep[1]+er[1]+icp+icr+ipr)
ec
ep
er
mo[1,1,1]
modci=aov(desvabs~carbonatacion*presion*rapidez,data = base)
modci$coefficients
a=model.tables(modci)
scintt=sum(2*a$tables$`carbonatacion:presion:rapidez`^2)
pf(1,2,12,lower.tail = F)
drop1(modci,test = "F")
mod2=aov(desvabs~carbonatacion*presion+carbonatacion*rapidez+rapidez*presion,data = base)
drop1(mod2,test = "F")
mod2=aov(desvabs~carbonatacion*presion+rapidez*presion,data = base)
drop1(mod2,test = "F")
mod2=aov(desvabs~carbonatacion+rapidez*presion,data = base)
drop1(mod2,test = "F")
anova(mod2)
coef=mod2$coefficients;coef
vc1=c(1,1,0,0,0,0)
vc2=c(1,0,1,0,0,0)
vc3=c(c(1,-1,-1,0,0,0))
coef%*%vc1
coef%*%vc2
coef%*%vc3
mc
vc1=c(1,1,0,0,0,0)
vc2=c(1,0,1,0,0,0)
vc3=c(1,-1,-1,0,0,0)
mc
vd12=c(1,0,1,0,0,0)-c(1,1,0,0,0,0)
vd13=c(1,-1,-1,0,0,0)-c(1,1,0,0,0,0)
vd23=c(1,-1,-1,0,0,0)-c(1,0,1,0,0,0)
d12=coef%*%vd12;d12
d13=coef%*%vd13;d13
d23=coef%*%vd23;d23
View(base)
anova(mod2)
sqrt((2*0.625)/8)
load("papel.Rdata")
str(base)
base$metodo=as.factor(base$metodo)
base$temp=as.factor(base$temp)
base$lote=as.factor(base$lote)
table(base$lote,base$metodo)
library(lattice)
xyplot(res ~ metodo, groups=temp,type="a",auto.key=list(columns=4),xlab="metodo",ylab="res",data=base)
library(lme4)
mod=lmer(base$res~base$metodo*base$temp+(1|base$lote))
anova(mod)
a=3
r=3
glm=a*(r-1)
glm
glt=nrow(base)-12-glm
glt
f=2.2967
pf(f,glm,glt,lower.tail = F)
glm
glt
options(contrasts = c("contr.sum","contr.poly"))
mod1=lmer(base$res~base$metodo+base$temp+(1|base$lote))
anova(mod1)
table(base$metodo)
pf(24.6241,2,24,lower.tail = F)
pf(3.9724,2,6,lower.tail = F)
table(base$temp)
coef=summary(mod1)$coef[,1]
coef
v1=c(1,0,0,1,0,0)
v2=c(1,0,0,0,1,0)
v3=c(1,0,0,0,0,1)
v4=c(1,0,0,-1,-1,-1)
v12=v2-v1
v13=v3-v1
v14=v4-v1
v23=v3-v2
v24=v4-v2
v34=v4-v3
l1=v12%*%coef
l2=v13%*%coef
l3=v14%*%coef
l4=v23%*%coef
l5=v24%*%coef
l6=v34%*%coef
ee=sqrt(t(v12)%*%vcov(mod1)%*%v12)
table(base$temp)
q1=l1/ee
q2=l2/ee
q3=l3/ee
q4=l4/ee
q5=l5/ee
q6=l6/ee
anova(mod1)
ptukey(as.numeric(q1)*sqrt(2),4,24,lower.tail = F)
ptukey(as.numeric(q2)*sqrt(2),4,24,lower.tail = F)
ptukey(as.numeric(q3)*sqrt(2),4,24,lower.tail = F)
ptukey(as.numeric(q4)*sqrt(2),4,24,lower.tail = F)
ptukey(as.numeric(q5)*sqrt(2),4,24,lower.tail = F)
ptukey(as.numeric(q6)*sqrt(2),4,24,lower.tail = F)
library(lsmeans)
lsmeans(mod1,pairwise~"temp",adjust="tukey")
load("papel.Rdata")
str(base)
base$metodo=as.factor(base$metodo)
base$temp=as.factor(base$temp)
base$lote=as.factor(base$lote)
table(base$lote,base$metodo)
library(lattice)
xyplot(res ~ metodo, groups=temp,type="a",auto.key=list(columns=4),xlab="metodo",ylab="res",data=base)
library(lme4)
mod=lmer(base$res~base$metodo*base$temp+(1|base$lote))
anova(mod)
a=3
r=3
glm=a*(r-1)
glm
glt=nrow(base)-12-glm
glt
f=2.2967
pf(f,glm,glt,lower.tail = F)
glm
glt
gc()
x1=c(rep(c("a","b"),each=10))
source("~/.active-rstudio-document", echo=TRUE)
x1=c(rep(c("a","b"),each=10))
x2=c(rep(c("c","d"),each=10))
x2=c(rep(c("c","d"),each=10,times=2))
x1=c(rep(c("a","b"),each=10,times=2))
x2=c(rep(c("c","d"),each=10,times=2))
b=c(rep(1:20,each=1,times=2))
x1=as.factor(c(rep(c("a","b"),each=10,times=2)))
x2=as.factor(c(rep(c("c","d"),each=10,times=2)))
b=as.factor(c(rep(1:20,each=1,times=2)))
table(x1,x2)
x1=as.factor(c(rep(c("a","b"),each=10,times=1),rep(c("b","a"),each=10,times=1)))
x2=as.factor(c(rep(c("c","d"),each=10,times=1)))
b=as.factor(c(rep(1:20,each=1,times=2)))
table(x1,x2)
length(x1)
length(x2)
x1=as.factor(c(rep(c("a","b"),each=10,times=1),rep(c("b","a"),each=10,times=1)))
x2=as.factor(c(rep(c("c","d"),each=10,times=2)))
b=as.factor(c(rep(1:20,each=1,times=2)))
table(x1,x2)
length(x1)
length(x2)
y=rnorm(40,0,1)
mod=lm(y~x1*x2)
anova(mod)
mod=lm(y~x1*x2+b)
anova(mod)
table(b)
anova(mod)
table(b)
length(b)
anova(mod)
#x1=as.factor(c(rep(c("a","b"),each=10,times=1),rep(c("b","a"),each=10,times=1)))
x1=as.factor(c(rep(c("a","b"),each=10,times=1)))
x2=as.factor(c(rep(c("c","d"),each=10,times=1)))
length(x1)
length(x2)
b=as.factor(c(rep(1:20,each=1,times=1)))
mod=lm(y~x1*x2+b)
x1=as.factor(c(rep(c("a","b"),each=10,times=1)))
x2=as.factor(c(rep(c("c","d"),each=10,times=1)))
length(x1)
length(x2)
length(b)
table(x1,x2)
x1=as.factor(c(rep(c("a","b"),each=10,times=1),rep(c("b","a"),each=10,times=1)))
#x1=as.factor(c(rep(c("a","b"),each=10,times=1)))
x2=as.factor(c(rep(c("c","d"),each=10,times=1)))
b=as.factor(c(rep(1:20,each=1,times=1)))
y=rnorm(40,0,1)
mod=lm(y~x1*x2+b)
b=as.factor(c(rep(1:20,each=1,times=2)))
y=rnorm(40,0,1)
mod=lm(y~x1*x2+b)
anova(mod)
table(x1,x2)
#x1=as.factor(c(rep(c("a","b"),each=10,times=1)))
x2=as.factor(c(rep(c("c","d"),each=10,times=2)))
b=as.factor(c(rep(1:20,each=1,times=2)))
y=rnorm(40,0,1)
mod=lm(y~x1*x2+b)
anova(mod)
table(x1,x2)
length(b)
anova(mod)
mod=lm(y~x1*x2)
anova(mod)
mod=lm(y~x1+x2)
anova(mod)
table(x1,x2)
mod=lm(y~x1)
anova(mod)
mod=lm(y~x1+x2)
anova(mod)
mod=lm(y~x1+x2+b)
anova(mod)
cbind(x1,x2,b,y)
rbind(x1,x1)
c(x1,x1)
x1=c(x1,x1)
x2=c(x2,x2)
b=c(b,b)
y=rnorm(40,0,1)
mod=lm(y~x1+x2+b)
length(x1)
length(x2)
length(b)
y=rnorm(80,0,1)
mod=lm(y~x1+x2+b)
anova(mod)
21.071/18
21.071/19
source("~/.active-rstudio-document", echo=TRUE)
21.071/18
x1
x1
x1=as.factor(c(rep(c("a","b"),each=10,times=1),rep(c("b","a"),each=10,times=1)))
x1
x1=c("a","b","a","b")
x2=c("c","d","c","d")
table(x1,x2)
x1=c("a","b","a","b")
x2=c("c","d","d","c")
table(x1,x2)
x1=c("a","b","a","b","a","b","a","b")
x2=c("c","d","d","c","c","d","d","c")
table(x1,x2)
cbind(x1,x2)
x1=c("a","b","a","b","a","b","a","b")
x2=c("c","d","d","c","c","d","d","c")
b=c(1,1,1,1,2,2,2,2)
x1=as.factor(c("a","b","a","b","a","b","a","b"))
x2=as.factor(c("c","d","d","c","c","d","d","c"))
b=as.factor(c(1,1,1,1,2,2,2,2))
table(x1,x2)
cbind(x1,x2)
cbind(x1,x2,b)
cbind(x1,b)
x1=as.factor(c("a","b","c","d","a","b","c","d"))
cbind(x1,b)
y=rnorm(8)
mod=lm(y~x1+b)
anova(mod)
b=as.factor(c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4))
x1=as.factor(c("a","b","c","d","a","b","c","d","a","b","c","d","a","b","c","d"))
x2=as.factor(c("c","d","d","c","c","d","d","c"))
b=as.factor(c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4))
y=rnorm(8)
y=rnorm(16)
mod=lm(y~x1+b)
anova(mod)
knitr::include_graphics("C:/Users/danie/OneDrive/Cosas/Escritorio/Carrera/Experimentos/Fotos resumenes/5.png")
knitr::include_graphics("C:/Users/danie/OneDrive/Cosas/Escritorio/Carrera/Experimentos/Fotos resumenes/8.png")
knitr::include_graphics("C:/Users/danie/OneDrive/Cosas/Escritorio/Carrera/Experimentos/Fotos resumenes/9.png")
knitr::include_graphics("C:/Users/danie/OneDrive/Cosas/Escritorio/Carrera/Experimentos/Fotos resumenes/10.png")
v1=c(1,0)
v2=c(0,1)
v3=c(-1,-1)
v4=c(-1,0)
v5=c(0,-1)
v6=c(1,1)
v1%*%coef
coef=c(0.085,-0.068)
v1=c(1,0)
v2=c(0,1)
v3=c(-1,-1)
v4=c(-1,0)
v5=c(0,-1)
v6=c(1,1)
v1%*%coef
crossprod(v1,coef)
coef=c(0.085,-0.068)
v1=c(1,0)
v2=c(0,1)
v3=c(-1,-1)
v4=c(-1,0)
v5=c(0,-1)
v6=c(1,1)
v1%*%coef
crossprod(v1,coef)
v2%*%coef
crossprod(v2,coef)
v3%*%coef
crossprod(v3,coef)
v4%*%coef
crossprod(v4,coef)
v5%*%coef
crossprod(v5,coef)
v6%*%coef
crossprod(v6,coef)
c(v1%*%coef,v2%*%coef,v3%*%coef,v4%*%coef,v5%*%coef,v6%*%coef)
r=4
ef=c(v1%*%coef,v2%*%coef,v3%*%coef,v4%*%coef,v5%*%coef,v6%*%coef)
scint=sum(r*ef^2);scint
cmint=scint/((3-1)*(2-1));cmint
int
sample(1:10,3,replace = F)
cmresA=5.0101
cmresB=1.3056
fb=6
fa=9
n=(fb+1)*(fa+3)*cmresA
d=(fb+3)*(fa+1)*cmresB
n
d
eer=n/d;eer
4*round(eer)
y=c(1.79,1.84,2.15,2.23,2.01,1.90,1.81,1.69,1.94,2.09,2.17,2.3)
com=rep(c("Comedero1","Comedero2"),each=2,times=3)
sup=rep(c("Linaza","Soya","Girasol"),each=4,times=1);sup
df=data.frame(y,com,sup)
library(ggplot2)
ggplot(df,aes(x=com,y=y,group = sup))+
stat_summary(fun="mean",geom = "line",aes(linetype = sup))
v1=c(1,1,0,0,0)
v2=c(1,0,1,0,0)
v3=c(1,-1,-1,0,0)
v1-v2
v1-v3
v2-v3
ef=c(0.085,-0.068)
t1=c(1,0)
t2=c(-1,0)
t3=c(0,1)
t4=c(0,-1)
t5=c(-1,-1)
t6=c(1,1)
int=c(t1%*%ef,t2%*%ef,t3%*%ef,t4%*%ef,t5%*%ef,t6%*%ef)
int
r=4
scint=sum(r*int^2)
cmint=scint/((2-1)*(3-1))
cmint
n=r*6
n
var=c(0.002,0.018,0.017,0.010,0.012,0.006)
scres=sum((r-1)*var);scres
cmres=scres/(n-6)
cmres
var=c(0.002,0.018,0.017,0.010,0.012,0.006)
scres=sum((r-1)*var)
4*6
cmres=scres/(24-6)
cmres
f=cmint/cmres
f
((3-1)*(2-1))
pf(f,((3-1)*(2-1)),18,lower.tail = F)
pf(f,((3-1)*(2-1)),18,lower.tail = F)>0.05
pf(f,((3-1)*(2-1)),18,lower.tail = F)
qf(0.95,((3-1)*(2-1)),18,lower.tail = F)
qf(0.05,((3-1)*(2-1)),18,lower.tail = F)
pf(f,((3-1)*(2-1)),18,lower.tail = F)
a1=c(1,-1,0,0,0,0)
a2=c(0,0,1,-1,0,0)
a3=c(0,0,0,0,1,-1)
a1%*%a2
a2%*%a3
a1=c(1,-1,0,0,0,0)
a2=c(0,0,1,-1,0,0)
a3=c(0,0,0,0,1,-1)
a1%*%a2
a1%*%a3
a2%*%a3
