coef
base=read.csv("maderas.csv")
str(base)
base$conc=as.factor(base$conc)
base$dia=as.factor(base$dia)
modc=lm(res~dia,data = base)
fit=modc$fit
rc=base$res-fit+mean(base$res)
boxplot(res~conc,data = base)
boxplot(rc~base$conc)
mod1=lm(res~conc+dia,data = base)
sum(anova(mod1)[,2])
sum((20)*var)
options(contrasts = c("contr.sum","contr.poly"))
mod2=lm(res~dia+conc,data = base)
coef=mod2$coefficients
coef
coef=coef[c(8:13)]
coef
options(contrasts = c("contr.sum","contr.poly"))
mod2=lm(res~dia+conc,data = base)
coef=mod2$coefficients
coef
coef=coef[c(1,8:13)]
coef
c1=c(1,1,0,0,0,0,0)
c2=c(1,0,1,0,0,0,0)
c3=c(1,0,0,1,0,0,0)
c4=c(1,0,0,0,1,0,0)
c5=c(1,0,0,0,0,1,0)
c6=c(1,0,0,0,0,0,1)
c7=c(1,-1,-1,-1,-1,-1,-1)
coef%*%c1
c1=c(1,1,0,0,0,0,0)
c2=c(1,0,1,0,0,0,0)
c3=c(1,0,0,1,0,0,0)
c4=c(1,0,0,0,1,0,0)
c5=c(1,0,0,0,0,1,0)
c6=c(1,0,0,0,0,0,1)
c7=c(1,-1,-1,-1,-1,-1,-1)
coef%*%c1
coef%*%c2
coef%*%c3
coef%*%c4
coef%*%c5
coef%*%c6
coef%*%c7
(mo=tapply(base$res,base$conc,mean))
vcov(mod2)
vcov(mod2)
1
coef
coef[-1]
coef=coef[-1]
vcov(mod2)
coef=coef[-1]
vcov(mod2)
vcov(mod2)[c(8:13),-c(8:13)]
vcov(mod2)[c(-1,8:13),-c(8:13)]
vcov(mod2)[c(-1,8:13),-c(-1,8:13)]
vcov(mod2)[c(8:13),-c(8:13)]
vcov(mod2)[-1]
vcov(mod2)[,-1]
vcov=vcov(mod2)[,-1]
vcov[c(8:13),-c(8:13)]
vcov=vcov[c(8:13),-c(8:13)]
vcov
coef=coef[-1]
vcov=vcov(mod2)[,-1]
vcov=vcov[c(8:13),c(8:13)]
vcov
vcov=vcov[,c(8:13)]
vcov
coef=coef[-1]
vcov=vcov(mod2)[,-1]
vcov=vcov[,c(8:13)]
coef=coef[-1]
vcov=vcov(mod2)[,-1]
vcov
vcov=vcov[,c(8:13)]
vcov
coef=coef[-1]
vcov=vcov(mod2)[,-1]
vcov=vcov[,c(8:13)]
vcov
vcov=vcov(mod2)[c(8:13),c(8:13)]
vcov
c1=c(1,0,0,0,0,0)
c2=c(0,1,0,0,0,0)
c3=c(0,0,1,0,0,0)
c4=c(0,0,0,1,0,0)
c5=c(0,0,0,0,1,0)
c6=c(0,0,0,0,0,1)
c7=c(-1,-1,-1,-1,-1,-1)
coef=coef[-1]
vcov=vcov(mod2)[c(8:13),c(8:13)]
vcov
c1=c(1,0,0,0,0,0)
c2=c(0,1,0,0,0,0)
c3=c(0,0,1,0,0,0)
c4=c(0,0,0,1,0,0)
c5=c(0,0,0,0,1,0)
c6=c(0,0,0,0,0,1)
c7=c(-1,-1,-1,-1,-1,-1)
coef=coef[-1]
vcov=vcov(mod2)[c(8:13),c(8:13)]
vcov
l12=c1-c2
l13=c1-c3
l14=c1-c4
l15=c1-c5
l16=c1-c6
l17=c1-c7
l23=c2-c3
l24=c2-c4
l25=c2-c5
l26=c2-c6
l27=c2-c7
l34=c3-c4
l35=c3-c5
l36=c3-c6
l37=c3-c7
l45=c4-c5
l46=c4-c6
l47=c4-c7
l56=c5-c6
l57=c5-c7
l67=c6-c7
t(l12)%*%vcov%*%l12
t(l12)%*%vcov%*%l12
t(l13)%*%vcov%*%l12
t(l14)%*%vcov%*%l12
t(l12)%*%vcov%*%l12
t(l13)%*%vcov%*%l13
t(l14)%*%vcov%*%l14
cmres
cmtrat=sctrata/6
base=read.csv("maderas.csv")
str(base)
base$conc=as.factor(base$conc)
base$dia=as.factor(base$dia)
modc=lm(res~dia,data = base)
fit=modc$fit
rc=base$res-fit+mean(base$res)
boxplot(res~conc,data = base)
boxplot(rc~base$conc)
mod1=lm(res~conc+dia,data = base)
sum(anova(mod1)[,2])
sum((20)*var)
base=read.csv("maderas.csv")
str(base)
base$conc=as.factor(base$conc)
base$dia=as.factor(base$dia)
modc=lm(res~dia,data = base)
fit=modc$fit
rc=base$res-fit+mean(base$res)
boxplot(res~conc,data = base)
boxplot(rc~base$conc)
mod1=lm(res~conc+dia,data = base)
sum(anova(mod1)[,2])
anova(mod1)[3,2]
a=7
yk=tapply(base$res,base$dia,mean)
yb=mean(base$res)
anova(mod1)
sum(3*(yk-yb)^2)
yjp=tapply(base$res,base$conc,sum)
ypk=tapply(base$res,base$dia,sum)
p=3
njk=table(base$conc,base$dia)
qj=yjp-as.vector(njk%*%ypk/p)
num=p*sum(qj^2)
r=3
a=7
lambda=r*(p-1)/(a-1)
sctrata=num/(lambda*a)
sctrata
scres=2600.286-(1317.429+1114.286);scres
cmtrat=sctrata/6
cmres=scres/((nrow(base)-1)-(6+6))
cmres
f=cmtrat/cmres;f
pf(f,6,8,lower.tail = F)
mod2=lm(res~dia+conc,data = base)
anova(mod2)
library(ibd)
aov.ibd(res~dia+conc,data = base)
options(contrasts = c("contr.sum","contr.poly"))
mod2=lm(res~dia+conc,data = base)
coef=mod2$coefficients
coef
cmres
2*cmres
(2*cmres)/3
(2*cmres)/2
sqrt(t(l12)%*%vcov%*%l12)
(2*cmres)/3
t(l12)%*%vcov%*%l12
(2*cmres)/3
(2*cmres)/3
anova(mod2)
sqrt((2*cmres)/3)
sqrt(t(l12)%*%vcov%*%l12)
sqrt((2*cmres)/3)
base=read.csv("maderas.csv")
str(base)
base$conc=as.factor(base$conc)
base$dia=as.factor(base$dia)
modc=lm(res~dia,data = base)
fit=modc$fit
rc=base$res-fit+mean(base$res)
boxplot(res~conc,data = base)
boxplot(rc~base$conc)
mod1=lm(res~conc+dia,data = base)
sum(anova(mod1)[,2])
anova(mod1)[3,2]
a=7
yk=tapply(base$res,base$dia,mean)
yb=mean(base$res)
anova(mod1)
sum(3*(yk-yb)^2)
yjp=tapply(base$res,base$conc,sum)
ypk=tapply(base$res,base$dia,sum)
p=3
njk=table(base$conc,base$dia)
qj=yjp-as.vector(njk%*%ypk/p)
num=p*sum(qj^2)
r=3
a=7
lambda=r*(p-1)/(a-1)
sctrata=num/(lambda*a)
sctrata
scres=2600.286-(1317.429+1114.286);scres
cmtrat=sctrata/6
cmres=scres/((nrow(base)-1)-(6+6))
cmres
f=cmtrat/cmres;f
pf(f,6,8,lower.tail = F)
mod2=lm(res~dia+conc,data = base)
anova(mod2)
library(ibd)
aov.ibd(res~dia+conc,data = base)
options(contrasts = c("contr.sum","contr.poly"))
mod2=lm(res~dia+conc,data = base)
coef=mod2$coefficients
coef
coef=coef[c(1,8:13)]
coef
c1=c(1,1,0,0,0,0,0)
c2=c(1,0,1,0,0,0,0)
c3=c(1,0,0,1,0,0,0)
c4=c(1,0,0,0,1,0,0)
c5=c(1,0,0,0,0,1,0)
c6=c(1,0,0,0,0,0,1)
c7=c(1,-1,-1,-1,-1,-1,-1)
coef%*%c1
coef%*%c2
coef%*%c3
coef%*%c4
coef%*%c5
coef%*%c6
coef%*%c7
(mo=tapply(base$res,base$conc,mean))
c1=c(1,1,0,0,0,0,0)
c2=c(1,0,1,0,0,0,0)
c3=c(0,0,1,0,0,0)
c4=c(0,0,0,1,0,0)
c5=c(0,0,0,0,1,0)
c6=c(0,0,0,0,0,1)
c7=c(-1,-1,-1,-1,-1,-1)
coef=coef[-1]
vcov=vcov(mod2)[c(1,8,9,10,11,12,13),c(1,8,9,10,11,12,13)]
l12=c1-c2
l13=c1-c3
l14=c1-c4
l15=c1-c5
l16=c1-c6
l17=c1-c7
l23=c2-c3
l24=c2-c4
l25=c2-c5
l26=c2-c6
l27=c2-c7
l34=c3-c4
l35=c3-c5
l36=c3-c6
l37=c3-c7
l45=c4-c5
l46=c4-c6
l47=c4-c7
l56=c5-c6
l57=c5-c7
l67=c6-c7
sqrt(t(l12)%*%vcov%*%l12)
vcov
base=read.csv("maderas.csv")
str(base)
base$conc=as.factor(base$conc)
base$dia=as.factor(base$dia)
modc=lm(res~dia,data = base)
fit=modc$fit
rc=base$res-fit+mean(base$res)
boxplot(res~conc,data = base)
boxplot(rc~base$conc)
mod1=lm(res~conc+dia,data = base)
sum(anova(mod1)[,2])
anova(mod1)[3,2]
a=7
yk=tapply(base$res,base$dia,mean)
yb=mean(base$res)
anova(mod1)
sum(3*(yk-yb)^2)
yjp=tapply(base$res,base$conc,sum)
ypk=tapply(base$res,base$dia,sum)
p=3
njk=table(base$conc,base$dia)
qj=yjp-as.vector(njk%*%ypk/p)
num=p*sum(qj^2)
r=3
a=7
lambda=r*(p-1)/(a-1)
sctrata=num/(lambda*a)
sctrata
scres=2600.286-(1317.429+1114.286);scres
cmtrat=sctrata/6
cmres=scres/((nrow(base)-1)-(6+6))
cmres
f=cmtrat/cmres;f
pf(f,6,8,lower.tail = F)
mod2=lm(res~dia+conc,data = base)
anova(mod2)
library(ibd)
aov.ibd(res~dia+conc,data = base)
options(contrasts = c("contr.sum","contr.poly"))
mod2=lm(res~dia+conc,data = base)
coef=mod2$coefficients
coef
coef=coef[c(1,8:13)]
coef
c1=c(1,1,0,0,0,0,0)
c2=c(1,0,1,0,0,0,0)
c3=c(1,0,0,1,0,0,0)
c4=c(1,0,0,0,1,0,0)
c5=c(1,0,0,0,0,1,0)
c6=c(1,0,0,0,0,0,1)
c7=c(1,-1,-1,-1,-1,-1,-1)
coef%*%c1
coef%*%c2
coef%*%c3
coef%*%c4
coef%*%c5
coef%*%c6
coef%*%c7
(mo=tapply(base$res,base$conc,mean))
c1=c(1,0,0,0,0,0)
c2=c(0,1,0,0,0,0)
c3=c(0,0,1,0,0,0)
c4=c(0,0,0,1,0,0)
c5=c(0,0,0,0,1,0)
c6=c(0,0,0,0,0,1)
c7=c(-1,-1,-1,-1,-1,-1)
coef=coef[-1]
vcov=vcov(mod2)[c(8:13),c(8:13)]
l12=c1-c2
l13=c1-c3
l14=c1-c4
l15=c1-c5
l16=c1-c6
l17=c1-c7
l23=c2-c3
l24=c2-c4
l25=c2-c5
l26=c2-c6
l27=c2-c7
l34=c3-c4
l35=c3-c5
l36=c3-c6
l37=c3-c7
l45=c4-c5
l46=c4-c6
l47=c4-c7
l56=c5-c6
l57=c5-c7
l67=c6-c7
sqrt(t(l12)%*%vcov%*%l12)
sqrt((2*cmres)/3)
l12=h12%*%coef
base=read.csv("maderas.csv")
str(base)
base$conc=as.factor(base$conc)
base$dia=as.factor(base$dia)
modc=lm(res~dia,data = base)
fit=modc$fit
rc=base$res-fit+mean(base$res)
boxplot(res~conc,data = base)
boxplot(rc~base$conc)
mod1=lm(res~conc+dia,data = base)
sum(anova(mod1)[,2])
anova(mod1)[3,2]
a=7
yk=tapply(base$res,base$dia,mean)
yb=mean(base$res)
anova(mod1)
sum(3*(yk-yb)^2)
yjp=tapply(base$res,base$conc,sum)
ypk=tapply(base$res,base$dia,sum)
p=3
njk=table(base$conc,base$dia)
qj=yjp-as.vector(njk%*%ypk/p)
num=p*sum(qj^2)
r=3
a=7
lambda=r*(p-1)/(a-1)
sctrata=num/(lambda*a)
sctrata
scres=2600.286-(1317.429+1114.286);scres
cmtrat=sctrata/6
cmres=scres/((nrow(base)-1)-(6+6))
cmres
f=cmtrat/cmres;f
pf(f,6,8,lower.tail = F)
mod2=lm(res~dia+conc,data = base)
anova(mod2)
library(ibd)
aov.ibd(res~dia+conc,data = base)
options(contrasts = c("contr.sum","contr.poly"))
mod2=lm(res~dia+conc,data = base)
coef=mod2$coefficients
coef
coef=coef[c(1,8:13)]
coef
c1=c(1,1,0,0,0,0,0)
c2=c(1,0,1,0,0,0,0)
c3=c(1,0,0,1,0,0,0)
c4=c(1,0,0,0,1,0,0)
c5=c(1,0,0,0,0,1,0)
c6=c(1,0,0,0,0,0,1)
c7=c(1,-1,-1,-1,-1,-1,-1)
coef%*%c1
coef%*%c2
coef%*%c3
coef%*%c4
coef%*%c5
coef%*%c6
coef%*%c7
(mo=tapply(base$res,base$conc,mean))
c1=c(1,0,0,0,0,0)
c2=c(0,1,0,0,0,0)
c3=c(0,0,1,0,0,0)
c4=c(0,0,0,1,0,0)
c5=c(0,0,0,0,1,0)
c6=c(0,0,0,0,0,1)
c7=c(-1,-1,-1,-1,-1,-1)
coef=coef[-1]
vcov=vcov(mod2)[c(8:13),c(8:13)]
h12=c1-c2
h13=c1-c3
h14=c1-c4
h15=c1-c5
h16=c1-c6
h17=c1-c7
h23=c2-c3
h24=c2-c4
h25=c2-c5
h26=c2-c6
h27=c2-c7
h34=c3-c4
h35=c3-c5
h36=c3-c6
h37=c3-c7
h45=c4-c5
h46=c4-c6
h47=c4-c7
h56=c5-c6
h57=c5-c7
h67=c6-c7
ee=sqrt(t(l12)%*%vcov%*%l12)
sqrt((2*cmres)/3)
l12=h12%*%coef
l12
(l12=h12%*%coef)
(l13=h13%*%coef)
(l14=h14%*%coef)
(l15=h15%*%coef)
(l16=h16%*%coef)
(l17=h17%*%coef)
cbind(h12,h13,h14,h15,h16,h17,h23,h24,h25,h26,h27,h34,h35,h36,h37,h45,h46,h47,h56,h57,h67)
h=cbind(h12,h13,h14,h15,h16,h17,h23,h24,h25,h26,h27,h34,h35,h36,h37,h45,h46,h47,h56,h57,h67)
l=t(h)%*%coef
l=h%*%coef
l=h%*%coef
l=t(h)%*%coef
l
l=abs(l)
l
q=l/ee
l
c(rep(ee))
l
nrow(l)
c(rep(ee),21)
c(rep(ee,21))
t(c(rep(ee,21)))
l%*%t(c(rep(ee,21)))
l%*%c(rep(ee,21))
(ee=sqrt(diag(t(h)%*%vcov%*%h)))
l/ee
q=l/ee
ptukey(p,8)
ptukey(q,8)
ptukey(q,df=8)
ptukey(q,7,8,lower.tail = F)
