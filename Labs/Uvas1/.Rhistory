base=read.csv("uvas.csv")
base$localidad=factor(base$localidad)
boxplot(base$brix~base$localidad);abline(a=mean(base$))
boxplot(base$brix~base$localidad);abline(a=mean(base$brix))
boxplot(base$brix~base$localidad);abline(mean(base$brix))
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
m=tapply(base$color,base$trat,mean);m #Media ppor trat
v=tapply(base$color,base$trat,var);v #Var por trat
media=mean(base$color);media # Media general
boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2) # Gráfico
taus=m-media;taus# Efectos por tratamiento
st=sum(taus);st # Suma de los efectos
ve=mean(v);ve # Varianza del error
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)
mod;mod1;aov(mod) # Ajustar el modelo con diferentes fórmulas
anova(mod);anova(mod1) # Análisis de varianza
cmres=anova(mod)[2,3] # Cuadrado medio residual
cmres;ve  # Son iguales
df=anova(mod)[2,1];df
sctrat=anova(mod)[1,2];sctrat #Suma de cuadrados del tratamiento
10*sum(taus**2) # Es igual a la suma de cuadrados de tratamiento
anova(mod)[1,3];anova(mod)[2,3]
(f=anova(mod)[1,3]/anova(mod)[2,3])
(p=pf(f,3,36,lower.tail = F))
coef=mod$coefficients;coef
model.matrix(mod)
coef
t1=c(1,0,0,0)
t2=c(1,1,0,0)
t3=c(1,0,1,0)
t4=c(1,0,0,1)
mc=c(coef%*%t1,coef%*%t2,coef%*%t3,coef%*%t4);mc
mc-media;taus
model.tables(mod1)
options(contrasts=c("contr.sum","contr.poly"))# Cambiar a suma nula
# options(contrasts=c("contr.treatment","contr.poly")) # Cambiar a referencia
contrasts(base$trat)
mod2=lm(color~trat,data = base)
mod2aov=aov(color~trat,data = base)
coef2=mod2$coefficients;coef2
model.matrix(mod2)
coef2
v1=c(1,1,0,0)
v2=c(1,0,1,0)
v3=c(1,0,0,1)
v4=c(1,-1,-1,-1)
mc2=c(coef2%*%v1,coef2%*%v2,coef2%*%v3,coef2%*%v4)
mc2-media
model.tables(mod2aov)
base1=rbind(base[base$trat=="control",],base[base$trat=="tapar",])
base1$trat=factor(as.numeric(base1$trat))
mod3=lm(color~trat,data = base1)
anova(mod3) # Se rechaza la hipótesis nula de igualdad de medias
summary(mod3) # Se rechaza la hipótesis nula t de igualdad de medias
boxplot(base$brix~base$localidad);abline(h=mean(base$brix))
base=read.csv("uvas.csv")
base$localidad=factor(base$localidad)
boxplot(base$brix~base$localidad);abline(h=mean(base$brix))
mean(base$)
load("manzanas.Rdata")
load("manzanas.Rdata")
View(base)
read.csv("manzanas.csv")
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
save(base,file="manzanas.Rdata") #Se guarda el archivo
load("C:/Users/danie/OneDrive/Cosas/Escritorio/Carrera/Experimentos/Labs/Manzanas1/manzanas.Rdata")
View(base)
View(base)
mod=lm(color~trat,data = base)
lm
options(contrasts=c("contr.sum","contr.poly"))
mod=lm(color~trat,data = base)
mod$coefficients
coef=mod$coefficients;coef
options(contrasts=c("contr.sum","contr.poly"))
mod=lm(color~trat,data = base)
coef=mod$coefficients;coef
contrasts(base$trat)
v1=c(1,-1/3,-1/3,-1/3)
v2=c(1,-1/2,-1/2,0)
v3=c(0,1,-1,0)
v1=c(1,-1/3,-1/3,-1/3)
v2=c(1,-1/2,-1/2,0)
v3=c(0,1,-1,0)
crossprod(v1,v2)
crossprod(v1,v3)
crossprod(v2,v3)
v1=c(1,-1/3,-1/3,-1/3)
v2=c(0,-1/2,-1/2,1)
v3=c(0,1,-1,0)
crossprod(v1,v2)
crossprod(v1,v3)
crossprod(v2,v3)
