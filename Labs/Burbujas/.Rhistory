#install.packages("nlme")
library(nlme)
modm1=lme(tiempo~glicerina, random = ~1|persona,data = base1)
anova(modm1);anova(mod1);anova(mod2)
#install.packages("lme4",type = "source")
library(lme4)
modm2=lmer(tiempo~glicerina+(1|persona),data = base1)
summary(modm2)
t=3.379
pt(t,((12-1)-(2-1+6-1)),lower.tail = F)*2
anova(mod1)
bartlett.test(mod1$residuals~base1$glicerina)
modc2=lm(tiempo~persona,data = base2)
fit2=modc2$fit
rc2=base2$tiempo-fit2+mean(base1$tiempo)
boxplot(rc2~base2$glicerina+base2$agua)
boxplot(rc2~base2$agua+base2$glicerina)
ggplot(base2,aes(x=agua,y=tiempo,group = glicerina))+
stat_summary(fun = "mean",geom = "line",aes(linetype = glicerina))
mod3=lm(tiempo~glicerina*agua+persona,data = base2)
anova(mod3)
mod4=lm(tiempo~glicerina+agua+persona,data = base2)
anova(mod4)
table(base2$persona)
mgl=tapply(base2$tiempo,base2$glicerina,mean)
mg=mean(base2$tiempo)
mgl
sum(12*(mgl-mg)^2)
sum(6*(mgl-mg)^2)
mgl
mgl-mg
mg
sum(6*(mgl-mg)^2)
mg
mgl
sum(6*(mgl-mg)^2)
mg
mg
mgl
load("burbujas.Rdata")
str(base1)
base1$glicerina=as.factor(base1$glicerina)
base1$persona=as.factor(base1$persona)
str(base2)
base2$glicerina=as.factor(base2$glicerina)
base2$persona=as.factor(base2$persona)
str(base3)
base3$glicerina=as.factor(base3$glicerina)
base3$persona=as.factor(base3$persona)
base3$nivel=as.factor(base3$nivel)
library(ggplot2)
ggplot(base1,aes(x=persona,y=tiempo,group = glicerina))+
stat_summary(fun = "mean",geom = "line",aes(linetype = glicerina))
modc=lm(tiempo~persona,data = base1)
fit=modc$fit
cent=base1$tiempo-fit+mean(base1$tiempo)
boxplot(tiempo~glicerina,data = base1)
boxplot(cent~base1$glicerina,data = base1)
mod1=lm(base1$tiempo~base1$glicerina+base1$persona)
mod2=lm(cent~base1$glicerina)
anova(mod1)
anova(mod2)
mb=tapply(base1$tiempo,base1$persona,mean)
mg=mean(base1$tiempo)
scbloque=sum(2*(mb-mg)^2)
cmbloque=scbloque/5
vg=tapply(base1$tiempo,base1$glicerina,var)
cmres=(sum(5*vg)-scbloque)/((12-1)-(2-1+6-1));cmres
(mt=tapply(base1$tiempo,base1$glicerina,mean))
cmtrat=(sum(6*(mt-mg)^2))/1
f=cmtrat/cmres;f
pf(f,1,((12-1)-(2-1+6-1)),lower.tail = F)
#install.packages("nlme")
library(nlme)
modm1=lme(tiempo~glicerina, random = ~1|persona,data = base1)
anova(modm1);anova(mod1);anova(mod2)
#install.packages("lme4",type = "source")
library(lme4)
modm2=lmer(tiempo~glicerina+(1|persona),data = base1)
summary(modm2)
t=3.379
pt(t,((12-1)-(2-1+6-1)),lower.tail = F)*2
anova(mod1)
bartlett.test(mod1$residuals~base1$glicerina)
modc2=lm(tiempo~persona,data = base2)
fit2=modc2$fit
rc2=base2$tiempo-fit2+mean(base1$tiempo)
boxplot(rc2~base2$glicerina+base2$agua)
boxplot(rc2~base2$agua+base2$glicerina)
ggplot(base2,aes(x=agua,y=tiempo,group = glicerina))+
stat_summary(fun = "mean",geom = "line",aes(linetype = glicerina))
mod3=lm(tiempo~glicerina*agua+persona,data = base2)
anova(mod3)
mod4=lm(tiempo~glicerina+agua+persona,data = base2)
anova(mod4)
table(base2$persona)
mgl=tapply(base2$tiempo,base2$glicerina,mean)
mg=mean(base2$tiempo)
sum(6*(mgl-mg)^2)
mg
mg
sum(6*(mgl-mg)^2)
sum(c(1:10)*(mgl-mg)^2)
mg
sum(1*(mgl-mg)^2)
sum(2*(mgl-mg)^2)
sum(3*(mgl-mg)^2)
sum(4*(mgl-mg)^2)
sum(5*(mgl-mg)^2)
sum(6*(mgl-mg)^2)
sum(7*(mgl-mg)^2)
sum(6*(mgl-mg)^2)
table(base2$persona)
View(base2)
sum(table(base2$persona))
sum(36*(mgl-mg)^2)
sum(20*(mgl-mg)^2)
mgl=tapply(base2$tiempo,base2$glicerina,mean)
mg=mean(base2$tiempo)
sum(table(base2$persona))
sum(10*(mgl-mg)^2)
mg
mgl=tapply(base2$tiempo,base2$glicerina,mean)
mg=mean(base2$tiempo)
sum(table(base2$persona))
sum(10*(mgl-mg)^2)
mg
sum(20*(mgl-mg)^2)
sum(15*(mgl-mg)^2)
sum(16*(mgl-mg)^2)
sum(17*(mgl-mg)^2)
sum(18*(mgl-mg)^2)
cmtrat=sum(18*(mgl-mg)^2) ## Por qué 18?
cmtrat
table(base2$glicerina)
(mt=tapply(base1$tiempo,base1$glicerina,mean))
cmtrat=(sum(6*(mt-mg)^2))/1
cmtrat
(mt=tapply(base1$tiempo,base1$glicerina,mean))
cmtrat=(sum(6*(mt-mg)^2))/1
cmtrat
anova(mod1)
anova(mod2)
load("burbujas.Rdata")
str(base1)
base1$glicerina=as.factor(base1$glicerina)
base1$persona=as.factor(base1$persona)
str(base2)
base2$glicerina=as.factor(base2$glicerina)
base2$persona=as.factor(base2$persona)
str(base3)
base3$glicerina=as.factor(base3$glicerina)
base3$persona=as.factor(base3$persona)
base3$nivel=as.factor(base3$nivel)
library(ggplot2)
ggplot(base1,aes(x=persona,y=tiempo,group = glicerina))+
stat_summary(fun = "mean",geom = "line",aes(linetype = glicerina))
modc=lm(tiempo~persona,data = base1)
fit=modc$fit
cent=base1$tiempo-fit+mean(base1$tiempo)
boxplot(tiempo~glicerina,data = base1)
boxplot(cent~base1$glicerina,data = base1)
mod1=lm(base1$tiempo~base1$glicerina+base1$persona)
mod2=lm(cent~base1$glicerina)
anova(mod1)
anova(mod2)
mb=tapply(base1$tiempo,base1$persona,mean)
mg=mean(base1$tiempo)
scbloque=sum(2*(mb-mg)^2)
cmbloque=scbloque/5
vg=tapply(base1$tiempo,base1$glicerina,var)
cmres=(sum(5*vg)-scbloque)/((12-1)-(2-1+6-1));cmres
(mt=tapply(base1$tiempo,base1$glicerina,mean))
cmtrat=(sum(6*(mt-mg)^2))/1
cmtrat
table(base1$glicerina)
c(12.17,4.53,12.92,9.50)
k=c(12.17,4.53,12.92,9.50)
sum(5*(k-9.78))
sum(5*(k-9.78)^2)
table(base2$glicerina,base2$agua)
mod4
load("burbujas.Rdata")
str(base1)
base1$glicerina=as.factor(base1$glicerina)
base1$persona=as.factor(base1$persona)
str(base2)
base2$glicerina=as.factor(base2$glicerina)
base2$persona=as.factor(base2$persona)
str(base3)
base3$glicerina=as.factor(base3$glicerina)
base3$persona=as.factor(base3$persona)
base3$nivel=as.factor(base3$nivel)
library(ggplot2)
ggplot(base1,aes(x=persona,y=tiempo,group = glicerina))+
stat_summary(fun = "mean",geom = "line",aes(linetype = glicerina))
modc=lm(tiempo~persona,data = base1)
fit=modc$fit
cent=base1$tiempo-fit+mean(base1$tiempo)
boxplot(tiempo~glicerina,data = base1)
boxplot(cent~base1$glicerina,data = base1)
mod1=lm(base1$tiempo~base1$glicerina+base1$persona)
mod2=lm(cent~base1$glicerina)
anova(mod1)
anova(mod2)
mb=tapply(base1$tiempo,base1$persona,mean)
mg=mean(base1$tiempo)
scbloque=sum(2*(mb-mg)^2)
cmbloque=scbloque/5
vg=tapply(base1$tiempo,base1$glicerina,var)
cmres=(sum(5*vg)-scbloque)/((12-1)-(2-1+6-1));cmres
(mt=tapply(base1$tiempo,base1$glicerina,mean))
cmtrat=(sum(6*(mt-mg)^2))/1
cmtrat
table(base1$glicerina)
f=cmtrat/cmres;f
pf(f,1,((12-1)-(2-1+6-1)),lower.tail = F)
#install.packages("nlme")
library(nlme)
modm1=lme(tiempo~glicerina, random = ~1|persona,data = base1)
anova(modm1);anova(mod1);anova(mod2)
#install.packages("lme4",type = "source")
library(lme4)
modm2=lmer(tiempo~glicerina+(1|persona),data = base1)
summary(modm2)
t=3.379
pt(t,((12-1)-(2-1+6-1)),lower.tail = F)*2
anova(mod1)
bartlett.test(mod1$residuals~base1$glicerina)
modc2=lm(tiempo~persona,data = base2)
fit2=modc2$fit
rc2=base2$tiempo-fit2+mean(base1$tiempo)
boxplot(rc2~base2$glicerina+base2$agua)
boxplot(rc2~base2$agua+base2$glicerina)
ggplot(base2,aes(x=agua,y=tiempo,group = glicerina))+
stat_summary(fun = "mean",geom = "line",aes(linetype = glicerina))
mod3=lm(tiempo~glicerina*agua+persona,data = base2)
anova(mod3)
mod4=lm(tiempo~glicerina+agua+persona,data = base2)
anova(mod4)
mgl=tapply(base2$tiempo,base2$glicerina,mean)
mg=mean(base2$tiempo)
sum(table(base2$persona))
cmtrat=sum(18*(mgl-mg)^2) ## Por qué 18? Agarra las replicas pero en la presentación la CMTrat para bloques es diferente
cmtrat
table(base2$glicerina)
mod4
options
options(contrasts = c("contr.sum","contr.poly"))
mod4=lm(tiempo~glicerina+agua+persona,data = base2)
anova(mod4)
mgl=tapply(base2$tiempo,base2$glicerina,mean)
mg=mean(base2$tiempo)
sum(table(base2$persona))
cmtrat=sum(18*(mgl-mg)^2) ## Por qué 18? Agarra las replicas pero en la presentación la CMTrat para bloques es diferente
cmtrat
table(base2$glicerina)
mod4
mod4$
```
mod4$coef
coef4=mod4$coef
coef4
c(1,1,0,0,0,0,0,0,0)
v1=c(1,1,0,0,0,0,0,0,0)
v1%*%coef4
v1=c(1,1,0,0,0,0,0,0,0)
v1%*%coef4
v1=c(1,1,0,0,0,0,0,0,0)
v2=c(1,-1,0,0,0,0,0,0,0)
v1%*%coef4
v2%*%coef4
dif=v1-v2
v1%*%coef4
v2%*%coef4
l=dif%*%coef
l=dif%*%coef4
l
v1=c(1,1,0,0,0,0,0,0,0)
v2=c(1,-1,0,0,0,0,0,0,0)
dif=v2-v1
l=dif%*%coef4
l
t(dif)%*%vcov(mod4)%*%dif
sqrt(t(dif)%*%vcov(mod4)%*%dif)
ee=sqrt(t(dif)%*%vcov(mod4)%*%dif)
qt(1-0.05,27,lower.tail = F)
qt(1-0.05,27,lower.tail = T)
qt(1-0.05,27,lower.tail = T)
(nrow(base2))
(nrow(base2)-1)-(2-1+3-1)
(nrow(base2)-1)-(2-1+3-1)
qt(1-0.05,(nrow(base2)-1)-(2-1+3-1),lower.tail = T)
T=qt(1-0.05,(nrow(base2)-1)-(2-1+3-1),lower.tail = T)
t=qt(1-0.05,(nrow(base2)-1)-(2-1+3-1),lower.tail = T)
(nrow(base2)-1)-(6-1+3-1)
(nrow(base2)-1)-(6-1+6-1)
(nrow(base2)-1)-(6-1+6-1)
t=qt(1-0.05,(nrow(base2)-1)-(2-1+3-1),lower.tail = T)
l-t*ee
l+t*ee
l-t*ee
l+t*ee
(3-1)*(2-1)+(36-6)
l-t*ee
l+t*ee
t=qt(1-0.05,27,lower.tail = T)
l-t*ee
l+t*ee
l-t*ee
l+t*ee
anova(mod4)
table(base2$agua)
coef4
vv1=c(1,0,1,0,0,0,0,0,0)
vv1=c(1,0,1,0,0,0,0,0,0)
vv2=c(1,0,0,1,0,0,0,0,0)
vv3=c(1,0,-1,-1,0,0,0,0,0)
dd1=vv1-vv2;dd1
dd3=vv2-vv3;dd3
coef4%*%dd1
coef4%*%dd1
coef4%*%dd2
vv1=c(1,0,1,0,0,0,0,0,0)
vv2=c(1,0,0,1,0,0,0,0,0)
vv3=c(1,0,-1,-1,0,0,0,0,0)
dd1=vv1-vv2;dd1
dd2=vv1-vv3;dd2
dd3=vv2-vv3;dd3
coef4%*%dd1
coef4%*%dd2
coef4%*%dd3
vv1=c(1,0,1,0,0,0,0,0,0)
vv2=c(1,0,0,1,0,0,0,0,0)
vv3=c(1,0,-1,-1,0,0,0,0,0)
dd1=vv1-vv2;dd1
dd2=vv1-vv3;dd2
dd3=vv3-vv2;dd3
coef4%*%dd1
coef4%*%dd2
coef4%*%dd3
vv1=c(1,0,1,0,0,0,0,0,0)
vv2=c(1,0,0,1,0,0,0,0,0)
vv3=c(1,0,-1,-1,0,0,0,0,0)
dd1=vv1-vv2;dd1
dd2=vv1-vv3;dd2
dd3=vv3-vv2;dd3
ll1=coef4%*%dd1
ll2=coef4%*%dd2
ll3=coef4%*%dd3
est1=sqrt(t(dd1)%*%vcov(mod4)%*%dd1)
est1=sqrt(t(dd1)%*%vcov(mod4)%*%dd1)
est2=sqrt(t(dd2)%*%vcov(mod4)%*%dd2)
est3=sqrt(t(dd3)%*%vcov(mod4)%*%dd3)
et1=ll1/est1
et2=ll2/est2
et3=ll3/est3
dd1%*%dd2
dd1%*%dd2
dd1%*%dd3
dd3%*%dd2
ptukey(et1)
ptukey(et1,3,27)
ptukey(et1,3,27,lower.tail = F)
et1
anova(mod4)
cmres4=25.26
table(base2$agua)
cmres4*(1/12+1?12)
cmres4*(1/12+1/12)
sqrt(cmres4*(1/12+1/12))
est1
eet=sqrt(cmres4*(1/12+1/12))
est1
et1
et1=ll1/eet
et2=ll2/eet
et3=ll3/eet
ptukey(et1,3,27,lower.tail = F)
ptukey(et1,3,27,lower.tail = F)
ptukey(et1,3,27,lower.tail = F)
ptukey(et2,3,27,lower.tail = F)
ptukey(et3,3,27,lower.tail = F)
ptukey(et1*sqrt(2),3,27,lower.tail = F)
ptukey(et2*sqrt(2),3,27,lower.tail = F)
ptukey(et3*sqrt(2),3,27,lower.tail = F)
qt1=qt(1-0.05/2,27)
qt
qt1
ll1-qt1
ll1-qt1*eet
ll2-qt1*eet
qt1=qt(1-0.05/1,27)
ll1-qt1*eet
ll2-qt1*eet
load("burbujas.Rdata")
str(base1)
base1$glicerina=as.factor(base1$glicerina)
base1$persona=as.factor(base1$persona)
str(base2)
base2$glicerina=as.factor(base2$glicerina)
base2$persona=as.factor(base2$persona)
str(base3)
base3$glicerina=as.factor(base3$glicerina)
base3$persona=as.factor(base3$persona)
base3$nivel=as.factor(base3$nivel)
library(ggplot2)
ggplot(base1,aes(x=persona,y=tiempo,group = glicerina))+
stat_summary(fun = "mean",geom = "line",aes(linetype = glicerina))
modc=lm(tiempo~persona,data = base1)
fit=modc$fit
cent=base1$tiempo-fit+mean(base1$tiempo)
boxplot(tiempo~glicerina,data = base1)
boxplot(cent~base1$glicerina,data = base1)
mod1=lm(base1$tiempo~base1$glicerina+base1$persona)
mod2=lm(cent~base1$glicerina)
anova(mod1)
anova(mod2)
mb=tapply(base1$tiempo,base1$persona,mean)
mg=mean(base1$tiempo)
scbloque=sum(2*(mb-mg)^2)
cmbloque=scbloque/5
vg=tapply(base1$tiempo,base1$glicerina,var)
cmres=(sum(5*vg)-scbloque)/((12-1)-(2-1+6-1));cmres
(mt=tapply(base1$tiempo,base1$glicerina,mean))
cmtrat=(sum(6*(mt-mg)^2))/1
cmtrat
table(base1$glicerina)
f=cmtrat/cmres;f
pf(f,1,((12-1)-(2-1+6-1)),lower.tail = F)
#install.packages("nlme")
library(nlme)
modm1=lme(tiempo~glicerina, random = ~1|persona,data = base1)
anova(modm1);anova(mod1);anova(mod2)
#install.packages("lme4",type = "source")
library(lme4)
modm2=lmer(tiempo~glicerina+(1|persona),data = base1)
summary(modm2)
t=3.379
pt(t,((12-1)-(2-1+6-1)),lower.tail = F)*2
anova(mod1)
bartlett.test(mod1$residuals~base1$glicerina)
modc2=lm(tiempo~persona,data = base2)
fit2=modc2$fit
rc2=base2$tiempo-fit2+mean(base1$tiempo)
boxplot(rc2~base2$glicerina+base2$agua)
boxplot(rc2~base2$agua+base2$glicerina)
ggplot(base2,aes(x=agua,y=tiempo,group = glicerina))+
stat_summary(fun = "mean",geom = "line",aes(linetype = glicerina))
mod3=lm(tiempo~glicerina*agua+persona,data = base2)
anova(mod3)
options(contrasts = c("contr.sum","contr.poly"))
mod4=lm(tiempo~glicerina+agua+persona,data = base2)
anova(mod4)
mgl=tapply(base2$tiempo,base2$glicerina,mean)
mg=mean(base2$tiempo)
sum(table(base2$persona))
cmtrat=sum(18*(mgl-mg)^2) ## Por qué 18? Agarra las replicas pero en la presentación la CMTrat para bloques es diferente
cmtrat
table(base2$glicerina)
coef4=mod4$coef
coef4
v1=c(1,1,0,0,0,0,0,0,0)
v2=c(1,-1,0,0,0,0,0,0,0)
dif=v2-v1
l=dif%*%coef4
l
ee=sqrt(t(dif)%*%vcov(mod4)%*%dif)
(nrow(base2)-1)-(6-1+6-1)
t=qt(1-0.05,27) ## Preguntar grados de libertad
l-t*ee
l+t*ee
anova(mod4)
table(base2$agua)
coef4
vv1=c(1,0,1,0,0,0,0,0,0)
vv2=c(1,0,0,1,0,0,0,0,0)
vv3=c(1,0,-1,-1,0,0,0,0,0)
dd1=vv1-vv2;dd1
dd2=vv1-vv3;dd2
dd3=vv3-vv2;dd3
## Son ortogonales? No, tengo que hacer tukey
dd1%*%dd2
dd1%*%dd3
dd3%*%dd2
ll1=coef4%*%dd1
ll2=coef4%*%dd2
ll3=coef4%*%dd3
est1=sqrt(t(dd1)%*%vcov(mod4)%*%dd1)
est2=sqrt(t(dd2)%*%vcov(mod4)%*%dd2)
est3=sqrt(t(dd3)%*%vcov(mod4)%*%dd3)
cmres4=25.26
table(base2$agua)
eet=sqrt(cmres4*(1/12+1/12))
est1
et1=ll1/eet
et2=ll2/eet
et3=ll3/eet
ptukey(et1*sqrt(2),3,27,lower.tail = F)
ptukey(et2*sqrt(2),3,27,lower.tail = F)
ptukey(et3*sqrt(2),3,27,lower.tail = F)
qt1=qt(1-0.05/1,27) ## Por qué no sew hace bonferroni?
View(base3)
modp=lmer(tiempo~glicerina+nivel)
modp=lmer(tiempo~glicerina+nivel,data = base3)
modp=lmer(tiempo~glicerina+nivel+(1|persona),data = base3)
drop1(modp,test = "Chisq")
modp=lmer(tiempo~glicerina*nivel+(1|persona),data = base3)
drop1(modp,test = "Chisq")
modp1=lmer(tiempo~glicerina+nivel+(1|persona),data = base3)
modp1=lmer(tiempo~glicerina+nivel+(1|persona),data = base3)
drop1(modp1,test = "Chisq")
