coef
coef
base=read.csv("tortugas2.csv")
base$especie=as.factor(base$especie)
base$cond=as.factor(base$cond)
mg=mean(base$proteina);mg
msc=tapply(base$proteina,base$cond,mean);msc
a1=msc[1]-mg;a1
a2=msc[2]-mg;a2
a3=msc[3]-mg;a3
mse=tapply(base$proteina,base$especie,mean);mse
b1=mse[1]-mg;b1
b2=mse[2]-mg;b2
mo=tapply(base$proteina,list(base$especie,base$cond),mean);mo
a1b1=mg+a1+b1
a2b1=mg+a2+b1
a3b1=mg+a3+b1
a1b2=mg+a1+b2
a2b2=mg+a2+b2
a3b2=mg+a3+b2
mes=rbind(c(a1b1,a2b1,a3b1),c(a1b2,a2b2,a3b2));mes
library(ggplot2)
ggplot(base,aes(x=especie,y=proteina,group = cond))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = cond))
mo-mes
mod=aov(proteina~especie*cond,data = base)
model.tables(mod)
boxplot(base$proteina~base$especie+base$cond)
vt=tapply(base$proteina,list(base$especie,base$cond),var);vt
bartlett.test(proteina~interaction(especie,cond),data = base)
options(contrasts = c("contr.sum","contr.poly"))
mod2=lm(proteina~especie*cond,data = base)
model.matrix(mod2)
coef=mod2$coefficients;coef
c(0,-1,0,0,0,0)%*%coef
c(0,0,-1,-1,0,0)%*%coef
c(0,0,0,0,-1,-1)%*%coef ## Especie 1 cond 3
c(0,0,0,0,-1,0)%*%coef ## Especie 2 cond 1
c(0,0,0,0,0,-1)%*%coef ##Especie 2 cond 2
c(0,0,0,0,1,1)%*%coef ##Especie 2 cond 3
coef
c(1,1,1,0,1,0)%*%coef
mo
coef
c(1,1,1,0,1,0)%*%coef
c(1,1,1,0,1,0)%*%coef
coef
c(1,1,0,1,1,-1)%*%coef
mo
c(1,1,0,1,1,0)%*%coef
mo
coef
c(1,1,0,1,0,1)%*%coef
mo
coef
c(1,1,-1,-1,-1,-1)%*%coef
mo
coef
c(1,-1,1,0,-1,0)%*%coef
mo
c(1,-1,0,-1,0,1)%*%coef
coef
mo
c(1,-1,0,-1,0,1)%*%coef
coef
c(1,-1,0,1,0,-1)%*%coef
mo
c(1,-1,-1,-1,1,1)%*%coef
mo
coef
c(1,1,1,0,1,0)%*%coef
c(1,1,0,1,0,1)%*%coef
c(1,1,-1,-1,-1,-1)%*%coef
c(1,-1,1,0,-1,0)%*%coef
c(1,-1,0,1,0,-1)%*%coef
c(1,-1,-1,-1,1,1)%*%coef
anova(mod2)
r=table(base$especie,base$cond)
r=table(base$especie,base$cond);r
mes-mo
int=mes-mo;int
sum(r*int^2)
sum(r*int^2)/((3-1)*(2-1))
vt
sum((r-1)*vt)
sum((r-1)*vt)/(24-6)
cmres=sum((r-1)*vt)/(24-6)
f=cmint/cmres;f
r=4
int=mes-mo;int
cmint=sum(r*int^2)/((3-1)*(2-1))
cmres=sum((r-1)*vt)/(24-6)
f=cmint/cmres;f
pf(f,2,18,lower.tail = F)
cmres
vt
cmres
anova(mod2)
anova(mod2)[,1]
anova(mo2)
anova(mod2)
sum(4*c(a1,a2,a3))
a1
a2
a3
sum(4*c(a1,a2,a3)^2)
sum(4*c(a1,a2,a3)^2)
sum(4*c(a1,a2,a3)^2)
sum(4*c(a1,a2,a3)^2)
sum(4*c(a1,a2,a3)^2)
sum(4*c(a1,a2,a3)^2)
sum(4*c(a1,a2,a3)^2)
sum(4*c(a1,a2,a3)^2)
table(base$cond)
sum(8*c(a1,a2,a3)^2)
sum(8*c(a1,a2,a3)^2)/2
table(base$especie)
sum(12*c(b1,b2)^2)/1
sum(r*int^2)
View(base)
coef
v1=c(1,1,1,0,1,0)-c(1,1,0,1,0,1)
v2=c(1,1,1,0,1,0)-c(1,1,-1,-1,-1,-1)
v3=c(1,1,0,1,0,1)-c(1,1,-1,-1,-1,-1)
v4=c(1,-1,1,0,-1,0)-c(1,-1,0,1,0,-1)
v5=c(1,-1,1,0,-1,0)-c(1,-1,-1,-1,1,1)
v6=c(1,-1,0,1,0,-1)-c(1,-1,-1,-1,1,1)
v1,v2,v3,v4,v5,v6
c(v1,v2,v3,v4,v5,v6)
v1;v2;v3;v4;v5;v6
rbind(v1,v2,v3,v43,v5,v6)
rbind(v1,v2,v3,v4,v5,v6)
mat=rbind(v1,v2,v3,v4,v5,v6)
class(mat)
mat=as.matrix(mat)
class(maty)
class(mat)
mat[1,]
l1=v1%*%coef;l1
l1=v1%*%coef;l1
l2=v2%*%coef;l2
l3=v3%*%coef;l3
l4=v4%*%coef;l4
l5=v5%*%coef;l5
l6=v6%*%coef;l6
mo
l2=v2%*%coef;l2
l1=v1%*%coef;l1
l2=v2%*%coef;l2
l3=v3%*%coef;l3
l4=v4%*%coef;l4
l5=v5%*%coef;l5
l6=v6%*%coef;l6
v1%*%v2
v1%*%v2
v1%*%v2
v1%*%v3
v2%*%v3
v4%*%v5
v4%*%v5
v4%*%v6
v5%*%v6
v1%*%v4
v1%*%v4
v1%*%v5
v1%*%v6
v2%*%v4
v2%*%v5
v2%*%v6
v3%*%v4
v3%*%v5
v3%*%v6
l3=v3%*%coef;l3
mo
mo
mo
v1=c(1,1,0,1,0,1)-c(1,1,1,0,1,0)
v2=c(1,1,1,0,1,0)-c(1,1,-1,-1,-1,-1)
v3=c(1,1,0,1,0,1)-c(1,1,-1,-1,-1,-1)
v1%*%v2
v1%*%v3
v2%*%v3
v4=c(1,-1,1,0,-1,0)-c(1,-1,0,1,0,-1)
v5=c(1,-1,1,0,-1,0)-c(1,-1,-1,-1,1,1)
v6=c(1,-1,0,1,0,-1)-c(1,-1,-1,-1,1,1)
v4%*%v5
v4%*%v6
v5%*%v6
v1%*%v4
v1%*%v5
v1%*%v6
v2%*%v4
v2%*%v5
v2%*%v6
v3%*%v4
v3%*%v5
v3%*%v6
mat=rbind(v1,v2,v3,v4,v5,v6)
mat=as.matrix(mat)
mo
l1=v1%*%coef;l1
l2=v2%*%coef;l2
l3=v3%*%coef;l3
l4=v4%*%coef;l4
l5=v5%*%coef;l5
l6=v6%*%coef;l6
v1=c(1,1,0,1,0,1)-c(1,1,1,0,1,0)
v2=c(1,1,-1,-1,-1,-1)-c(1,1,1,0,1,0)
v3=c(1,1,0,1,0,1)-c(1,1,-1,-1,-1,-1)
v1%*%v2
v1%*%v3
v2%*%v3
v4=c(1,-1,1,0,-1,0)-c(1,-1,0,1,0,-1)
v5=c(1,-1,1,0,-1,0)-c(1,-1,-1,-1,1,1)
v6=c(1,-1,0,1,0,-1)-c(1,-1,-1,-1,1,1)
v4%*%v5
v4%*%v6
v5%*%v6
v1%*%v4
v1%*%v5
v1%*%v6
v2%*%v4
v2%*%v5
v2%*%v6
v3%*%v4
v3%*%v5
v3%*%v6
mat=rbind(v1,v2,v3,v4,v5,v6)
mat=as.matrix(mat)
mo
l1=v1%*%coef;l1
l2=v2%*%coef;l2
l3=v3%*%coef;l3
l4=v4%*%coef;l4
l5=v5%*%coef;l5
l6=v6%*%coef;l6
v1=c(1,1,0,1,0,1)-c(1,1,1,0,1,0)
v2=c(1,1,-1,-1,-1,-1)-c(1,1,1,0,1,0)
v3=c(1,1,0,1,0,1)-c(1,1,-1,-1,-1,-1)
v1%*%v2
v1%*%v3
v2%*%v3
v4=c(1,-1,0,1,0,-1)-c(1,-1,1,0,-1,0)
v5=c(1,-1,-1,-1,1,1)-c(1,-1,1,0,-1,0)
v6=c(1,-1,-1,-1,1,1)0-c(1,-1,0,1,0,-1)
v1=c(1,1,0,1,0,1)-c(1,1,1,0,1,0)
v2=c(1,1,-1,-1,-1,-1)-c(1,1,1,0,1,0)
v3=c(1,1,0,1,0,1)-c(1,1,-1,-1,-1,-1)
v1%*%v2
v1%*%v3
v2%*%v3
v4=c(1,-1,0,1,0,-1)-c(1,-1,1,0,-1,0)
v5=c(1,-1,-1,-1,1,1)-c(1,-1,1,0,-1,0)
v6=c(1,-1,-1,-1,1,1)-c(1,-1,0,1,0,-1)
v4%*%v5
v4%*%v6
v5%*%v6
v1%*%v4
v1%*%v5
v1%*%v6
v2%*%v4
v2%*%v5
v2%*%v6
v3%*%v4
v3%*%v5
v3%*%v6
mat=rbind(v1,v2,v3,v4,v5,v6)
mat=as.matrix(mat)
mo
l1=v1%*%coef;l1
l2=v2%*%coef;l2
l3=v3%*%coef;l3
l4=v4%*%coef;l4
l5=v5%*%coef;l5
l6=v6%*%coef;l6
ee1=t(v1)%*%vcov(mod2)%*%v1;ee1
l1=v1%*%coef;l1
ee1=t(v1)%*%vcov(mod2)%*%v1;ee1
l2=v2%*%coef;l2
ee2=t(v2)%*%vcov(mod2)%*%v2;ee2
l3=v3%*%coef;l3
ee3=t(v3)%*%vcov(mod3)%*%v3;ee3
ee3=t(v3)%*%vcov(mod2)%*%v3;ee3
ee4=t(v4)%*%vcov(mod2)%*%v4;ee4
l1=v1%*%coef;l1
ee1=t(v1)%*%vcov(mod2)%*%v1;ee1
l2=v2%*%coef;l2
ee2=t(v2)%*%vcov(mod2)%*%v2;ee2
l3=v3%*%coef;l3
ee3=t(v3)%*%vcov(mod2)%*%v3;ee3
l4=v4%*%coef;l4
ee4=t(v4)%*%vcov(mod2)%*%v4;ee4
l5=v5%*%coef;l5
ee5=t(v5)%*%vcov(mod2)%*%v5;ee5
l6=v6%*%coef;l6
ee6=t(v6)%*%vcov(mod2)%*%v6;ee6
ee1=sqrt(t(v1)%*%vcov(mod2)%*%v1);ee1
l2=v2%*%coef;l2
ee2=sqrt(t(v2)%*%vcov(mod2)%*%v2);ee2
l3=v3%*%coef;l3
ee3=sqrt((v3)%*%vcov(mod2)%*%v3);ee3
l1=v1%*%coef;l1
ee1=sqrt(t(v1)%*%vcov(mod2)%*%v1);ee1
l2=v2%*%coef;l2
ee2=sqrt(t(v2)%*%vcov(mod2)%*%v2);ee2
l3=v3%*%coef;l3
ee3=sqrt((v3)%*%vcov(mod2)%*%v3);ee3
l4=v4%*%coef;l4
ee4=sqrt(t(v4)%*%vcov(mod2)%*%v4);ee4
l5=v5%*%coef;l5
ee5=sqrt(t(v5)%*%vcov(mod2)%*%v5);ee5
l6=v6%*%coef;l6
ee6=sqrt(t(v6)%*%vcov(mod2)%*%v6);ee6
t1=l1/ee1;t1
t1=l1/ee1;t1
t2=l2/ee2;t2
t3=l3/ee3;t3
t4=l4/ee4;t4
t5=l5/ee5;t5
t6=l6/ee6;t6
pt(t1,18,lower.tail = F)
pt(t1,18,lower.tail = F)
pt(t2,18,lower.tail = F)
pt(t3,18,lower.tail = F)
pt(t4,18,lower.tail = F)
pt(t5,18,lower.tail = F)
pt(t6,18,lower.tail = F)
T
T1
t1
0.05/3
pt(t1,18,lower.tail = F)<0.05/3
pt(t2,18,lower.tail = F)<0.05/3
pt(t3,18,lower.tail = F)<0.05/3
pt(t4,18,lower.tail = F)<0.05/3
pt(t5,18,lower.tail = F)<0.05/3
pt(t6,18,lower.tail = F)<0.05/3
qt(1-(0.05/3),lower.tail = F)
qt(1-(0.05/3),18,lower.tail = F)
qt(1-(0.05/3),18,lower.tail = T)
qt(1-(0.05/3),18)
tt1=qt(1-(0.05/3),18)
tt2=qt(1-(0.05/2),18)
l1-tt1*ee1
l3-tt1*ee3
l1-tt1*ee1
l2-tt1*ee2
l3-tt1*ee3
l4-tt2*ee4
l6-tt2*ee6
l5-tt2*ee5
l6-tt2*ee6
l5-tt2*ee5
l6-tt2*ee6
l1-tt1*ee1
l2-tt1*ee2
l3-tt1*ee3
l5-tt2*ee5
l6-tt2*ee6
pt(t4,18,lower.tail = F)<0.05/3
pt(t5,18,lower.tail = F)<0.05/3
pt(t6,18,lower.tail = F)<0.05/3
library(emmeans)
emmeans(mod2,pairwise~cond|especie,adjust="bonferroni")
em=emmeans(mod2,pairwise~cond|especie,adjust="bonferroni")
em$emmeans
em$contrasts
pt(t1,18,lower.tail = F)*6
pt(t2,18,lower.tail = F)*6
pt(t3,18,lower.tail = F)*6
pt(t4,18,lower.tail = F)*6
pt(t5,18,lower.tail = F)*6
pt(t6,18,lower.tail = F)*6
confint(em)
