d12=c(1,1,0,0,0,0)-c(1,0,1,0,0,0)
d13=c(1,1,0,0,0,0)-c(1,-1,-1,0,0,0)
d23=c(1,0,1,0,0,0)-c(1,-1,-1,0,0,0)
load("refrescos.rdata")
str(base)
mo=tapply(base$desvabs,list(base$carbonatacion,base$presion,base$rapidez),mean)
mo
library(ggplot2)
ggplot(base,aes(x=carbonatacion,y=desvabs,group = presion))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = presion))
ggplot(base,aes(x=rapidez,y=desvabs,group = presion))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = presion))
ggplot(base,aes(x=carbonatacion,y=desvabs,group = rapidez))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = rapidez))
mcp=tapply(base$desvabs,list(base$carbonatacion,base$presion),mean)
mpr=tapply(base$desvabs,list(base$presion,base$rapidez),mean)
mcr=tapply(base$desvabs,list(base$carbonatacion,base$rapidez),mean)
mcp
mpr
mcr
mc=tapply(base$desvabs,base$carbonatacion,mean)
mp=tapply(base$desvabs,base$presion,mean)
mr=tapply(base$desvabs,base$rapidez,mean)
mc;mp;mr
mg=mean(base$desvabs);mg
ec=mc-mg
ep=mp-mg
er=mr-mg
ec;ep;er
icp=mcp[1,1]-(mg+ec[1]+ep[1])
ipr=mpr[1,1]-(mg+ep[1]+er[1])
icr=mcr[1,1]-(mg+er[1]+ec[1])
icp
ipr
icr
options(contrasts = c("contr.sum","contr.poly"))
mod=lm(desvabs~carbonatacion*presion+carbonatacion*rapidez+rapidez*presion,data = base)
mod$coefficients
library(lattice)
xyplot(base$desvabs~base$carbonatacion|base$rapidez,group=base$presion,pch=18,type="a")
mo[1,1,1]-(mg+ec[1]+ep[1]+er[1]+icp+icr+ipr)
ec
ep
er
mo[1,1,1]
modci=aov(desvabs~carbonatacion*presion*rapidez,data = base)
modci$coefficients
a=model.tables(modci)
scintt=sum(2*a$tables$`carbonatacion:presion:rapidez`^2)
(2-1)*(2-1)*(3-1)
scintt/2
scintt
anova(modci)
pf(1,2,12,lower.tail = F)
drop1(modci,test = "F")
mod2=aov(desvabs~carbonatacion*presion+carbonatacion*rapidez+rapidez*presion,data = base)
drop1(mod2,test = "F")
mod2=aov(desvabs~carbonatacion*presion+rapidez*presion,data = base)
drop1(mod2,test = "F")
mod2=aov(desvabs~carbonatacion+rapidez*presion,data = base)
drop1(mod2,test = "F")
anova(mod2)
coef=mod2$coefficients;coef
vc1=c(1,1,0,0,0,0)
vc2=c(1,0,1,0,0,0)
vc3=c(c(1,-1,-1,0,0,0))
coef%*%vc1
coef%*%vc2
coef%*%vc3
mc
vc1=c(1,1,0,0,0,0)
vc2=c(1,0,1,0,0,0)
vc3=c(1,-1,-1,0,0,0)
d12=coef%*%vd12;d12
vd12=c(1,1,0,0,0,0)-c(1,0,1,0,0,0)
vd13=c(1,1,0,0,0,0)-c(1,-1,-1,0,0,0)
vd23=c(1,0,1,0,0,0)-c(1,-1,-1,0,0,0)
d12=coef%*%vd12;d12
vd12=c(1,1,0,0,0,0)-c(1,0,1,0,0,0)
vd13=c(1,1,0,0,0,0)-c(1,-1,-1,0,0,0)
vd23=c(1,0,1,0,0,0)-c(1,-1,-1,0,0,0)
d12=coef%*%vd12;d12
d13=coef%*%vd13;d13
d23=coef%*%vd23;d23
mc
vd12=c(1,0,1,0,0,0)-c(1,1,0,0,0,0)
vd13=c(1,1,0,0,0,0)-c(1,-1,-1,0,0,0)
vd23=c(1,0,1,0,0,0)-c(1,-1,-1,0,0,0)
d12=coef%*%vd12;d12
d13=coef%*%vd13;d13
d23=coef%*%vd23;d23
vd12=c(1,0,1,0,0,0)-c(1,1,0,0,0,0)
vd13=c(1,-1,-1,0,0,0)-c(1,1,0,0,0,0)
vd23=c(1,0,1,0,0,0)-c(1,-1,-1,0,0,0)
d12=coef%*%vd12;d12
d13=coef%*%vd13;d13
d23=coef%*%vd23;d23
vd12=c(1,0,1,0,0,0)-c(1,1,0,0,0,0)
vd13=c(1,-1,-1,0,0,0)-c(1,1,0,0,0,0)
vd23=c(1,-1,-1,0,0,0)-c(1,0,1,0,0,0)
d12=coef%*%vd12;d12
d13=coef%*%vd13;d13
d23=coef%*%vd23;d23
vd12%*%vd13
vd13%*%vd23
vd12%*%vd13
vd13%*%vd23
vd12%*%vd23
t(vd12)
t(vd12)%*%vcov(mod2)%*%vd12
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
vd12=c(1,0,1,0,0,0)-c(1,1,0,0,0,0)
vd13=c(1,-1,-1,0,0,0)-c(1,1,0,0,0,0)
vd23=c(1,-1,-1,0,0,0)-c(1,0,1,0,0,0)
d12=coef%*%vd12;d12
d13=coef%*%vd13;d13
d23=coef%*%vd23;d23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
ee12=t(vd12)%*%vcov(mod2)%*%vd12
ee13=t(vd13)%*%vcov(mod2)%*%vd13
ee23=t(vd23)%*%vcov(mod2)%*%vd23
ee12;ee13;ee23
(ee13=t(vd13)%*%vcov(mod2)%*%vd13)
t12=d12/ee12;t12
t13=d13/ee13;t13
t23=d23/ee23;t23
0.05/3
pt(t12,2,lower.tail = F)
0.05/3
pt(t12,2,lower.tail = F)
pt(t13,2,lower.tail = F)
pt(t23,2,lower.tail = F)
anova(mod2)
table(base$carbonatacion)
anova(mod2)
(2*0.625)/8
coef
coef
v.11=c(1,0,0,1,1,1)
v.21=c(1,0,0,1,-1,-1)
d.1=
d.1=v.11-v.21
d.1
l.1=coef%*%d.1
l.1
coef
v.11=c(1,0,0,1,1,1)
v.21=c(1,0,0,1,-1,-1)
d.1=v.21-v.21
l.1=coef%*%d.1
l.1
coef
v.11=c(1,0,0,1,1,1)
v.21=c(1,0,0,1,-1,-1)
d.1=v.21-v.11
l.1=coef%*%d.1
l.1
table(base$presion,base$rapidez)
t(d.1)%*%vcov(mod2)%*%d.1
ee.11=t(d.1)%*%vcov(mod2)%*%d.1
t.11=l.1/ee.11
t.11
table(base$presion)
pt(t.11,1,lower.tail = F)
coef
coef
v.11=c(1,0,0,1,1,1)
v.21=c(1,0,0,1,-1,-1)
v.12=c(1,0,0,-1,1,-1)
v.22=c(1,0,0,-1,-1,1)
d.1=v.21-v.11
d.2=v.12-v.22
l.1=coef%*%d.1
l.1
coef
v.11=c(1,0,0,1,1,1)
v.21=c(1,0,0,1,-1,-1)
v.12=c(1,0,0,-1,1,-1)
v.22=c(1,0,0,-1,-1,1)
d.1=v.21-v.11
d.2=v.12-v.22
l.1=coef%*%d.1
l.1
l.2=coef%*%d.2
l.2
coef
v.11=c(1,0,0,1,1,1)
v.21=c(1,0,0,1,-1,-1)
v.12=c(1,0,0,-1,1,-1)
v.22=c(1,0,0,-1,-1,1)
d.1=v.21-v.11
d.2=v.22-v.12
l.1=coef%*%d.1
l.1
l.2=coef%*%d.2
l.2
d.1%*%d.2
ee.11=t(d.1)%*%vcov(mod2)%*%d.1
ee.12=t(d.2)%*%vcov(mod2)%*%d.2
ee.12
t.12=l.2/ee.12
t.12
pt(t.12,1,lower.tail = F)
pt(t.11,1,lower.tail = F)
pt(t.12,1,lower.tail = F)
ee.11=sqrt(t(d.1)%*%vcov(mod2)%*%d.1)
ee.12=sqrt(t(d.2)%*%vcov(mod2)%*%d.2)
t.11=l.1/ee.11
t.11
t.12=l.2/ee.12
t.12
pt(t.11,1,lower.tail = F)
pt(t.12,1,lower.tail = F)
coef
l.1
l.2
ee12=sqrt(t(vd12)%*%vcov(mod2)%*%vd12)
ee13=sqrt(t(vd13)%*%vcov(mod2)%*%vd13)
ee23=sqrt(t(vd23)%*%vcov(mod2)%*%vd23)
ee12;ee13;ee23
0.05/3
pt(t12,2,lower.tail = F)
pt(t13,2,lower.tail = F)
pt(t23,2,lower.tail = F)
load("refrescos.rdata")
str(base)
mo=tapply(base$desvabs,list(base$carbonatacion,base$presion,base$rapidez),mean)
mo
library(ggplot2)
ggplot(base,aes(x=carbonatacion,y=desvabs,group = presion))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = presion))
ggplot(base,aes(x=rapidez,y=desvabs,group = presion))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = presion))
ggplot(base,aes(x=carbonatacion,y=desvabs,group = rapidez))+
stat_summary(fun.y = "mean",geom = "line",aes(linetype = rapidez))
mcp=tapply(base$desvabs,list(base$carbonatacion,base$presion),mean)
mpr=tapply(base$desvabs,list(base$presion,base$rapidez),mean)
mcr=tapply(base$desvabs,list(base$carbonatacion,base$rapidez),mean)
mcp
mpr
mcr
mc=tapply(base$desvabs,base$carbonatacion,mean)
mp=tapply(base$desvabs,base$presion,mean)
mr=tapply(base$desvabs,base$rapidez,mean)
mc;mp;mr
mg=mean(base$desvabs);mg
ec=mc-mg
ep=mp-mg
er=mr-mg
ec;ep;er
icp=mcp[1,1]-(mg+ec[1]+ep[1])
ipr=mpr[1,1]-(mg+ep[1]+er[1])
icr=mcr[1,1]-(mg+er[1]+ec[1])
icp
ipr
icr
options(contrasts = c("contr.sum","contr.poly"))
mod=lm(desvabs~carbonatacion*presion+carbonatacion*rapidez+rapidez*presion,data = base)
mod$coefficients
library(lattice)
xyplot(base$desvabs~base$carbonatacion|base$rapidez,group=base$presion,pch=18,type="a")
mo[1,1,1]-(mg+ec[1]+ep[1]+er[1]+icp+icr+ipr)
ec
ep
er
mo[1,1,1]
modci=aov(desvabs~carbonatacion*presion*rapidez,data = base)
modci$coefficients
a=model.tables(modci)
scintt=sum(2*a$tables$`carbonatacion:presion:rapidez`^2)
(2-1)*(2-1)*(3-1)
scintt/2
scintt
anova(modci)
pf(1,2,12,lower.tail = F)
drop1(modci,test = "F")
mod2=aov(desvabs~carbonatacion*presion+carbonatacion*rapidez+rapidez*presion,data = base)
drop1(mod2,test = "F")
mod2=aov(desvabs~carbonatacion*presion+rapidez*presion,data = base)
drop1(mod2,test = "F")
mod2=aov(desvabs~carbonatacion+rapidez*presion,data = base)
drop1(mod2,test = "F")
anova(mod2)
coef=mod2$coefficients;coef
vc1=c(1,1,0,0,0,0)
vc2=c(1,0,1,0,0,0)
vc3=c(c(1,-1,-1,0,0,0))
coef%*%vc1
coef%*%vc2
coef%*%vc3
mc
vc1=c(1,1,0,0,0,0)
vc2=c(1,0,1,0,0,0)
vc3=c(1,-1,-1,0,0,0)
mc
vd12=c(1,0,1,0,0,0)-c(1,1,0,0,0,0)
vd13=c(1,-1,-1,0,0,0)-c(1,1,0,0,0,0)
vd23=c(1,-1,-1,0,0,0)-c(1,0,1,0,0,0)
d12=coef%*%vd12;d12
d13=coef%*%vd13;d13
d23=coef%*%vd23;d23
vd12%*%vd13
vd13%*%vd23
vd12%*%vd23
ee12=sqrt(t(vd12)%*%vcov(mod2)%*%vd12)
ee13=sqrt(t(vd13)%*%vcov(mod2)%*%vd13)
ee23=sqrt(t(vd23)%*%vcov(mod2)%*%vd23)
ee12;ee13;ee23
t12=d12/ee12;t12
t13=d13/ee13;t13
t23=d23/ee23;t23
0.05/3
pt(t12,2,lower.tail = F)
pt(t13,2,lower.tail = F)
pt(t23,2,lower.tail = F)
sqrt((2*0.625)/8)
t.11=l.1/ee.11
t.11
t.12=l.2/ee.12
t.12
pt(t.11,1,lower.tail = F)
pt(t.12,1,lower.tail = F)
anova(mod2)
pt(t.11,18,lower.tail = F)
pt(t.12,18,lower.tail = F)
0.05/3
pt(t12,18,lower.tail = F)
pt(t13,18,lower.tail = F)
pt(t23,18,lower.tail = F)
0.05/3
pt(t12,18,lower.tail = F)
pt(t13,18,lower.tail = F)
pt(t23,18,lower.tail = F)
ptukey(t23,18,lower.tail = F)
0.05/3
ptukey(t12,3,18,lower.tail = F)
ptukey(t13,3,18,lower.tail = F)
ptukey(t23,3,18,lower.tail = F)
0.05/3
ptukey(t12*sqrt(2),3,18,lower.tail = F)
ptukey(t13*sqrt(2),3,18,lower.tail = F)
ptukey(t23*sqrt(2),3,18,lower.tail = F)
coef
coef
lr1=c(1,0,0,1,1,1)-c(1,0,0,-1,1,-1)
lr2=c(1,0,0,1,-1,-1)-c(1,0,0,-1,-1,1)
lr1%*%lr2
coef
hr1=c(1,0,0,1,1,1)-c(1,0,0,-1,1,-1)
hr2=c(1,0,0,1,-1,-1)-c(1,0,0,-1,-1,1)
hr1%*%hr2 ## Son ortogonales
lr1=hr1%*%coef;lr1
lr2=hr2%*%coef;lr2
coef
hr1=c(1,0,0,1,1,1)-c(1,0,0,-1,1,-1)
hr2=c(1,0,0,1,-1,-1)-c(1,0,0,-1,-1,1)
hr1%*%hr2 ## Son ortogonales
lr1=hr1%*%coef;lr1
lr2=hr2%*%coef;lr2
coef
hr1=c(1,0,0,1,1,1)-c(1,0,0,-1,1,-1)
hr2=c(1,0,0,-1,-1,1)-c(1,0,0,1,-1,-1)
hr1%*%hr2 ## Son ortogonales
lr1=hr1%*%coef;lr1
lr2=hr2%*%coef;lr2
coef
hr1=c(1,0,0,-1,1,-1)-c(1,0,0,1,1,1)
hr2=c(1,0,0,-1,-1,1)-c(1,0,0,1,-1,-1)
hr1%*%hr2 ## Son ortogonales
lr1=hr1%*%coef;lr1
lr2=hr2%*%coef;lr2
coef
hr1=c(1,0,0,-1,1,-1)-c(1,0,0,1,1,1)
hr2=c(1,0,0,-1,-1,1)-c(1,0,0,1,-1,-1)
hr1%*%hr2 ## Son ortogonales
lr1=hr1%*%coef;lr1
lr2=hr2%*%coef;lr2
er1=t(hr1)%*%vcov(mod2)%*%hr1
er1=t(hr1)%*%vcov(mod2)%*%hr1
er2=t(hr2)%*%vcov(mod2)%*%hr2
er2
er1
er2
er1=sqrt(t(hr1)%*%vcov(mod2)%*%hr1)
er2=sqrt(t(hr2)%*%vcov(mod2)%*%hr2)
er1
er2
tr1=lr1/er1;tr1
tr1=lr1/er1;tr1
tr2=lr2/er2;tr2
pt(tr1,18,lower.tail = F)
pt(tr1,18,lower.tail = F)
pt(tr2,18,lower.tail = F)
pt(tr1,18,lower.tail = F)
pt(tr2,18,lower.tail = F)
