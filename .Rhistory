base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
m=tapply(base$color,base$trat,mean);m
v=tapply(base$color,base$trat,var);v
media=mean(base$color);media
boxplot(base$color)
boxplot(base$color~base$trat)
m=tapply(base$color,base$trat,mean);m
v=tapply(base$color,base$trat,var);v
media=mean(base$color);media
boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2)
taus=m-media
taus=m-media;taus
st=sum(taus)
st=sum(taus);st
ve=mean(v)
ve=mean(v);ve
m=tapply(base$color,base$trat,mean);m #Media ppor trat
v=tapply(base$color,base$trat,var);v #Var por trat
media=mean(base$color);media # Media general
boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2) # Gráfico
taus=m-media;taus# Efectos por tratamiento
st=sum(taus);st # Suma de los efectos
ve=mean(v);ve # Varianza del error
taus=m-media;taus# Efectos por tratamiento
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)
mod
mod1
aov(mod)
anova(mod)
anova(mod);anova(mod1)
anova(mod)
anova(mod)$residuals
anova(mod)$res
anova(mod)
a=anova(mod)
a
cmres=anova(mod)[2,2]
cmres
anova(mod);anova(mod1) # Análisis de varianza
cmres=anova(mod)[2,3]
cmres
cmres;ve
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)
mod;mod1;aov(mod) # Ajustar el modelo con diferentes fórmulas
anova(mod);anova(mod1) # Análisis de varianza
cmres=anova(mod)[2,3] # Cuadrado medio residual
cmres;ve  # Son iguales
anova(mod);anova(mod1) # Análisis de varianza
anova(mod)[2,1]
df=anova(mod)[2,1];df
anova(mod)
anova(mod)[2,2]
anova(mod)[1,2]
sctrat=anova(mod)[1,2]
sctrat=anova(mod)[1,2];sctrat
69.2/3
taus
sum(taus**2)
10*sum(taus**2)
var(m)
var(m);cmres
var(m)/cmres
anova(mod)
sctrat=anova(mod)[1,2];sctrat #Suma de cuadrados del tratamiento
10*sum(taus**2) # Es igual a la suma de cuadrados de tratamiento
anova(mod)[1,3];anova(mod)[2,3]
(f=anova(mod)[1,3]/anova(mod)[2,3])
(p=pf(f,3,36,lower.tail = F))
anova(mod)
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
m=tapply(base$color,base$trat,mean);m #Media ppor trat
v=tapply(base$color,base$trat,var);v #Var por trat
media=mean(base$color);media # Media general
boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2) # Gráfico
taus=m-media;taus# Efectos por tratamiento
st=sum(taus);st # Suma de los efectos
ve=mean(v);ve # Varianza del error
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)
mod;mod1;aov(mod) # Ajustar el modelo con diferentes fórmulas
anova(mod);anova(mod1) # Análisis de varianza
cmres=anova(mod)[2,3] # Cuadrado medio residual
cmres;ve  # Son iguales
df=anova(mod)[2,1];df
sctrat=anova(mod)[1,2];sctrat #Suma de cuadrados del tratamiento
10*sum(taus**2) # Es igual a la suma de cuadrados de tratamiento
anova(mod)[1,3];anova(mod)[2,3]
(f=anova(mod)[1,3]/anova(mod)[2,3])
(p=pf(f,3,36,lower.tail = F))
summary(mod)
mod$coefficients
model.matrix(mod)
model.matrix(mod)
tau
taus
coef=mod$coefficients;coef
coef
coef
coef
coef
taus
coef
taus
coef
model.matrix(mod)
t1=c(1,0,0,0)
coef
coef
coef
t1=c(1,0,0,0)
t2=c(1,1,0,0)
t3=c(1,0,1,0)
t4=c(1,0,0,1)
coef%*%t1
coef
t1=c(1,0,0,0)
t2=c(1,1,0,0)
t3=c(1,0,1,0)
t4=c(1,0,0,1)
coef%*%t1
coef%*%t2
coef%*%t3
coef%*%t4
taus
taus
coef
t1=c(1,0,0,0)
t2=c(1,1,0,0)
t3=c(1,0,1,0)
t4=c(1,0,0,1)
coef%*%t1
coef%*%t2
coef%*%t3
coef%*%t4
taus
c(coef%*%t1,coef%*%t2,coef%*%t3,coef%*%t4)
mc=c(coef%*%t1,coef%*%t2,coef%*%t3,coef%*%t4)
mc=c(coef%*%t1,coef%*%t2,coef%*%t3,coef%*%t4);mc
m
mg
media-mc
mc-media
coef
t1=c(1,0,0,0)
t2=c(1,1,0,0)
t3=c(1,0,1,0)
t4=c(1,0,0,1)
mc=c(coef%*%t1,coef%*%t2,coef%*%t3,coef%*%t4);mc
mc-media
mc-media;taus
model.tables(mod1)
options(contrasts=c("contr.sum","contr.poly"))# Cambiar a suma nula
# options(contrasts=c("contr.treatment","contr.poly")) # Cambiar a referencia
contrasts(base$trat)
summary(mod)
mod$coefficients
mod$coefficients;coef
coef
mod2=lm(color~trat,data = base)
mod2$coefficients
coef2=mod2$coefficients
coef2=mod2$coefficients;coef2
media
mod2=lm(color~trat,data = base)
coef2=mod2$coefficients;coef2
taus
mod2=lm(color~trat,data = base)
coef2=mod2$coefficients;coef2
taus
model.matrix(mod2)
base
model.matrix(mod2)
coef2
coef2
v1=c(1,1,0,0)
v2=c(1,0,1,0)
v3=c(1,0,0,1)
v4=c(1,-1,-1,-1)
c(coef2%*%v1,coef2%*%v2,coef2%*%v3,coef2%*%v4)
mc2=c(coef2%*%v1,coef2%*%v2,coef2%*%v3,coef2%*%v4)
mc2
mc2-media
mod2=lm(color~trat,data = base)
mod2aov=aov(color~trat,data = base)
coef2=mod2$coefficients;coef2
model.tables(mod2aov)
base
levels(base$trat)
base[base$trat=="control" & base$trat=="tapar"]
base[base$trat=="control" & base$trat=="tapar",]
base[,base$trat=="control" & base$trat=="tapar"]
base[base$trat=="control",]
base2=rbind(base[base$trat=="control",],base[base$trat=="tapar",])
base2=rbind(base[base$trat=="control",],base[base$trat=="tapar",])
base2
View(base2)
base1=rbind(base[base$trat=="control",],base[base$trat=="tapar",])
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
m=tapply(base$color,base$trat,mean);m #Media ppor trat
v=tapply(base$color,base$trat,var);v #Var por trat
media=mean(base$color);media # Media general
boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2) # Gráfico
taus=m-media;taus# Efectos por tratamiento
st=sum(taus);st # Suma de los efectos
ve=mean(v);ve # Varianza del error
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)
mod;mod1;aov(mod) # Ajustar el modelo con diferentes fórmulas
anova(mod);anova(mod1) # Análisis de varianza
cmres=anova(mod)[2,3] # Cuadrado medio residual
cmres;ve  # Son iguales
df=anova(mod)[2,1];df
sctrat=anova(mod)[1,2];sctrat #Suma de cuadrados del tratamiento
10*sum(taus**2) # Es igual a la suma de cuadrados de tratamiento
anova(mod)[1,3];anova(mod)[2,3]
(f=anova(mod)[1,3]/anova(mod)[2,3])
(p=pf(f,3,36,lower.tail = F))
coef=mod$coefficients;coef
model.matrix(mod)
coef
t1=c(1,0,0,0)
t2=c(1,1,0,0)
t3=c(1,0,1,0)
t4=c(1,0,0,1)
mc=c(coef%*%t1,coef%*%t2,coef%*%t3,coef%*%t4);mc
mc-media;taus
model.tables(mod1)
options(contrasts=c("contr.sum","contr.poly"))# Cambiar a suma nula
# options(contrasts=c("contr.treatment","contr.poly")) # Cambiar a referencia
contrasts(base$trat)
mod2=lm(color~trat,data = base)
mod2aov=aov(color~trat,data = base)
coef2=mod2$coefficients;coef2
model.matrix(mod2)
coef2
v1=c(1,1,0,0)
v2=c(1,0,1,0)
v3=c(1,0,0,1)
v4=c(1,-1,-1,-1)
mc2=c(coef2%*%v1,coef2%*%v2,coef2%*%v3,coef2%*%v4)
mc2-media
model.tables(mod2aov)
base1=rbind(base[base$trat=="control",],base[base$trat=="tapar",])
base1$trat=factor(as.numeric(base1$trat)
mod3=lm(color~trat,data = base1)
base1$trat=factor(as.numeric(base1$trat)
mod3=lm(color~trat,data = base1)
base1$trat=factor(as.numeric(base1$trat))
mod3=lm(color~trat,data = base1)
anova(mod3)
summary(mod3)
t1t=4.667
eet=0.2357
t1t/eet
t1t=1.1
eet=0.2357
t1t/eet
t=t1t/eet;t
gl=20-2
pt(t,gl)
1-pt(t,gl)
(1-pt(t,gl))2*
(1-pt(t,gl))*2
pt(t,gl)
pt(t,gl,lower.tail = F)
pt(t,gl,lower.tail = F)*2
v1=c(1,-1,0,0)
v2=c(0,1,-1,0)
v1%*%v2
crossprod(v1,v2)
v1=c(1,-1,0,0)
v2=c(0,1,-1,0)
v1%*%v2
crossprod(v1,v2)
v1=c(1,-1/2,1/2)
v2=c(0,1,-1)
v1=c(1,-1/2,1/2)
v2=c(0,1,-1)
crossprod(v1,v2)
knitr::include_graphics("C:/Users/danie/OneDrive/Cosas/Escritorio/Carrera/Experimentos/Fotos resumenes/1.png")
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limon")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)=c("control","tapar","bolsa","limon")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
m=tapply(base$color,base$trat,mean);m #Media ppor trat
v=tapply(base$color,base$trat,var);v #Var por trat
media=mean(base$color);media # Media general
boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2) # Gráfico
taus=m-media;taus# Efectos por tratamiento
st=sum(taus);st # Suma de los efectos
ve=mean(v);ve # Varianza del error
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)
mod;mod1;aov(mod) # Ajustar el modelo con diferentes fórmulas
anova(mod);anova(mod1) # Análisis de varianza
cmres=anova(mod)[2,3] # Cuadrado medio residual
cmres;ve  # Son iguales
df=anova(mod)[2,1];df
sctrat=anova(mod)[1,2];sctrat #Suma de cuadrados del tratamiento
10*sum(taus**2) # Es igual a la suma de cuadrados de tratamiento
anova(mod)[1,3];anova(mod)[2,3]
(f=anova(mod)[1,3]/anova(mod)[2,3])
(p=pf(f,3,36,lower.tail = F))
coef=mod$coefficients;coef
model.matrix(mod)
coef
t1=c(1,0,0,0)
t2=c(1,1,0,0)
t3=c(1,0,1,0)
t4=c(1,0,0,1)
mc=c(coef%*%t1,coef%*%t2,coef%*%t3,coef%*%t4);mc
mc-media;taus
model.tables(mod1)
options(contrasts=c("contr.sum","contr.poly"))# Cambiar a suma nula
# options(contrasts=c("contr.treatment","contr.poly")) # Cambiar a referencia
contrasts(base$trat)
mod2=lm(color~trat,data = base)
mod2aov=aov(color~trat,data = base)
coef2=mod2$coefficients;coef2
model.matrix(mod2)
coef2
v1=c(1,1,0,0)
v2=c(1,0,1,0)
v3=c(1,0,0,1)
v4=c(1,-1,-1,-1)
mc2=c(coef2%*%v1,coef2%*%v2,coef2%*%v3,coef2%*%v4)
mc2-media
model.tables(mod2aov)
base1=rbind(base[base$trat=="control",],base[base$trat=="tapar",])
base1$trat=factor(as.numeric(base1$trat))
mod3=lm(color~trat,data = base1)
anova(mod3) # Se rechaza la hipótesis nula de igualdad de medias
summary(mod3) # Se rechaza la hipótesis nula t de igualdad de medias
t1t=1.1
eet=0.2357
t=t1t/eet;t
gl=20-2
(1-pt(t,gl))*2 # Se multiplica por dos porque es de dos colas
pt(t,gl,lower.tail = F)*2 ## Otra forma de hacerlo
mod
TukeyHSD(mod)
TukeyHSD(mod1)
