base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
m=tapply(base$color,base$trat,mean);m
v=tapply(base$color,base$trat,var);v
media=mean(base$color);media
boxplot(base$color)
boxplot(base$color~base$trat)
m=tapply(base$color,base$trat,mean);m
v=tapply(base$color,base$trat,var);v
media=mean(base$color);media
boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2)
taus=m-media
taus=m-media;taus
st=sum(taus)
st=sum(taus);st
ve=mean(v)
ve=mean(v);ve
m=tapply(base$color,base$trat,mean);m #Media ppor trat
v=tapply(base$color,base$trat,var);v #Var por trat
media=mean(base$color);media # Media general
boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2) # Gráfico
taus=m-media;taus# Efectos por tratamiento
st=sum(taus);st # Suma de los efectos
ve=mean(v);ve # Varianza del error
taus=m-media;taus# Efectos por tratamiento
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)
mod
mod1
aov(mod)
anova(mod)
anova(mod);anova(mod1)
anova(mod)
anova(mod)$residuals
anova(mod)$res
anova(mod)
a=anova(mod)
a
cmres=anova(mod)[2,2]
cmres
anova(mod);anova(mod1) # Análisis de varianza
cmres=anova(mod)[2,3]
cmres
cmres;ve
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)
mod;mod1;aov(mod) # Ajustar el modelo con diferentes fórmulas
anova(mod);anova(mod1) # Análisis de varianza
cmres=anova(mod)[2,3] # Cuadrado medio residual
cmres;ve  # Son iguales
anova(mod);anova(mod1) # Análisis de varianza
anova(mod)[2,1]
df=anova(mod)[2,1];df
anova(mod)
anova(mod)[2,2]
anova(mod)[1,2]
sctrat=anova(mod)[1,2]
sctrat=anova(mod)[1,2];sctrat
69.2/3
taus
sum(taus**2)
10*sum(taus**2)
var(m)
var(m);cmres
var(m)/cmres
anova(mod)
sctrat=anova(mod)[1,2];sctrat #Suma de cuadrados del tratamiento
10*sum(taus**2) # Es igual a la suma de cuadrados de tratamiento
anova(mod)[1,3];anova(mod)[2,3]
(f=anova(mod)[1,3]/anova(mod)[2,3])
(p=pf(f,3,36,lower.tail = F))
anova(mod)
