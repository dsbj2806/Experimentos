---
title: "Laboratorio Manzanas"
author: "Daniel Sibaja Salazar"
date: "2024-04-02"
output:
  html_document:
    toc: yes
    toc_float: yes
    css: "tema1.css"
---

# Preparación 

```{r}
base=read.csv("manzanas.csv",sep= ";") # Se lee el archivo
base$trat=factor(base$trat) # Se pone el factor
levels(base$trat)= c("control","tapar","bolsa","limón")
#save(base,file="manzanas.Rdata") #Se guarda el archivo
```

# Análisis gráfico

```{r}

m=tapply(base$color,base$trat,mean);m #Media ppor trat
v=tapply(base$color,base$trat,var);v #Var por trat
media=mean(base$color);media # Media general

boxplot(base$color~base$trat);abline(h=media,col=2);points(1:4,m,col=4,pch="-",cex=2) # Gráfico

taus=m-media;taus# Efectos por tratamiento

st=sum(taus);st # Suma de los efectos
ve=mean(v);ve # Varianza del error
```

Los efectos significan que: 

* El control aumenta el promedio general en 2.1
* Taparlos los disminuye en -0.1
* La bolsa lo disminuye en -0.5
* El limón lo disminuye en -1.5


# Análisis de varianza 

```{r}
mod=lm(color~trat,data = base)
mod1=aov(color~trat,data = base)

mod;mod1;aov(mod) # Ajustar el modelo con diferentes fórmulas

anova(mod);anova(mod1) # Análisis de varianza

cmres=anova(mod)[2,3] # Cuadrado medio residual
cmres;ve  # Son iguales

df=anova(mod)[2,1];df 
```

Son 36 grados de libertad residuales porque se definen como n-k


```{r}
sctrat=anova(mod)[1,2];sctrat #Suma de cuadrados del tratamiento

10*sum(taus**2) # Es igual a la suma de cuadrados de tratamiento
```

Debe de multiplicarse por las réplicas porque en caso de no ser balanceado hay que ponderar los datos  (Preguntar)


```{r}
anova(mod)[1,3];anova(mod)[2,3]

(f=anova(mod)[1,3]/anova(mod)[2,3])

(p=pf(f,3,36,lower.tail = F))
```

Ya que el F está lejano al 1 esperable y la probabilidad asociada es prácticamente 0 hay sospechas de que si hay tratamientos que producen efectos diferentes de 0.   


$$H0: \mu_1=\mu_2=\mu_3=\mu_4$$


H1: Al menos un par de promedios es distinto


Hay suficiente evidencia estadística para rechazar la hipótesis nula de que los promedios por tratamiento son todos iguales. 


